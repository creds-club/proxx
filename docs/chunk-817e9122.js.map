{"version":3,"file":"chunk-817e9122.js","sources":["../src/main/services/state/best-times.ts","../src/main/services/state/vibration-preference.ts"],"sourcesContent":["import * as tslib_1 from \"tslib\";\nimport { get, set } from \"idb-keyval\";\nfunction getKey(width, height, mines) {\n    // Order width and height, because a 90 degree rotated board is the same thing in terms of\n    // difficulty.\n    var _a = tslib_1.__read([width, height].sort(function (a, b) { return a - b; }), 2), size1 = _a[0], size2 = _a[1];\n    return \"hs:\" + size1 + \":\" + size2 + \":\" + mines;\n}\n/**\n * Submit a time. Returns the best time (which will equal `time` if it's a new best time)\n *\n * @param width\n * @param height\n * @param mines\n * @param time\n */\nexport function submitTime(width, height, mines, time) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var key, previousBest;\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    key = getKey(width, height, mines);\n                    return [4 /*yield*/, get(key)];\n                case 1:\n                    previousBest = _a.sent();\n                    if (typeof previousBest === \"number\" && time > previousBest) {\n                        return [2 /*return*/, previousBest];\n                    }\n                    // This is technically racy if someone finishes two games at the same time, but… who?\n                    set(key, time);\n                    return [2 /*return*/, time];\n            }\n        });\n    });\n}\n/** Get best time for a given board */\nexport function getBest(width, height, mines) {\n    var key = getKey(width, height, mines);\n    return get(key);\n}\n// Trigger Persistent Storage while we are at it.\n// Firefox shows an ugly permission prompt that doesn't really make sense to users, so… nahhhh.\nif (navigator.storage &&\n    navigator.storage.persist &&\n    !navigator.userAgent.includes(\"Firefox/\")) {\n    navigator.storage.persist();\n}\n//# sourceMappingURL=best-times.js.map","import * as tslib_1 from \"tslib\";\nimport { get, set } from \"idb-keyval\";\nexport var supportsVibration = \"vibrate\" in navigator;\n/**\n * Set vibration preference (true means will vibrate)\n *\n * @param vibrate\n */\nexport function setVibrationPreference(vibrate) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, set(\"vibrate\", vibrate)];\n                case 1:\n                    _a.sent();\n                    return [2 /*return*/];\n            }\n        });\n    });\n}\nexport function getVibrationPreference() {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n        var vibrate;\n        return tslib_1.__generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, get(\"vibrate\")];\n                case 1:\n                    vibrate = _a.sent();\n                    if (typeof vibrate === \"boolean\") {\n                        return [2 /*return*/, vibrate];\n                    }\n                    // if no value is assigned to \"vibrate\", return default value\n                    return [2 /*return*/, supportsVibration];\n            }\n        });\n    });\n}\n//# sourceMappingURL=vibration-preference.js.map"],"names":["getKey","width","height","mines","_a","tslib_1.__read","sort","a","b","navigator","storage","persist","userAgent","includes","supportsVibration","key","get","tslib_1.__awaiter","this","vibrate","tslib_1.__generator","label","sent","set","time","previousBest"],"mappings":"4GAEA,SAASA,EAAOC,EAAOC,EAAQC,GAG3B,IAAIC,EAAKC,SAAe,CAACJ,EAAOC,GAAQI,KAAK,SAAUC,EAAGC,GAAK,OAAOD,EAAIC,IAAO,GACjF,MAAO,MADsFJ,EAAG,GACzE,IADqFA,EAAG,GAC1E,IAAMD,EAqC3CM,UAAUC,SACVD,UAAUC,QAAQC,UACjBF,UAAUG,UAAUC,SAAS,aAC9BJ,UAAUC,QAAQC,cC5CXG,EAAoB,YAAaL,oBDmCrC,SAAiBR,EAAOC,EAAQC,GACnC,IAAIY,EAAMf,EAAOC,EAAOC,EAAQC,GAChC,OAAOa,MAAID,6BCnBR,WACH,OAAOE,YAAkBC,UAAM,OAAQ,EAAQ,WAC3C,IAAIC,EACJ,OAAOC,cAAoBF,KAAM,SAAUd,GACvC,OAAQA,EAAGiB,OACP,KAAK,EAAG,MAAO,CAAC,EAAaL,MAAI,YACjC,KAAK,EAED,MAAuB,kBADvBG,EAAUf,EAAGkB,QAEF,CAAC,EAAcH,GAGnB,CAAC,EAAcL,kCAxBnC,SAAgCK,GACnC,OAAOF,YAAkBC,UAAM,OAAQ,EAAQ,WAC3C,OAAOE,cAAoBF,KAAM,SAAUd,GACvC,OAAQA,EAAGiB,OACP,KAAK,EAAG,MAAO,CAAC,EAAaE,MAAI,UAAWJ,IAC5C,KAAK,EAED,OADAf,EAAGkB,OACI,CAAC,sBDCrB,SAAoBrB,EAAOC,EAAQC,EAAOqB,GAC7C,OAAOP,YAAkBC,UAAM,OAAQ,EAAQ,WAC3C,IAAIH,EAAKU,EACT,OAAOL,cAAoBF,KAAM,SAAUd,GACvC,OAAQA,EAAGiB,OACP,KAAK,EAED,OADAN,EAAMf,EAAOC,EAAOC,EAAQC,GACrB,CAAC,EAAaa,MAAID,IAC7B,KAAK,EAED,MAA4B,iBAD5BU,EAAerB,EAAGkB,SACsBE,EAAOC,EACpC,CAAC,EAAcA,IAG1BF,MAAIR,EAAKS,GACF,CAAC,EAAcA"}