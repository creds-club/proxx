{"version":3,"file":"index-605381e9.js","sources":["../src/main/rendering/no-motion-animator/index.ts"],"sourcesContent":["/**\n * Copyright 2019 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport * as tslib_1 from \"tslib\";\nimport { freeze, getTime } from \"../time-provider\";\nvar NoMotionAnimator = /** @class */ (function () {\n    function NoMotionAnimator(_numTilesX, _numTilesY, _renderer) {\n        this._numTilesX = _numTilesX;\n        this._numTilesY = _numTilesY;\n        this._renderer = _renderer;\n        freeze();\n    }\n    Object.defineProperty(NoMotionAnimator.prototype, \"numTiles\", {\n        get: function () {\n            return this._numTilesX * this._numTilesY;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    NoMotionAnimator.prototype.updateCells = function (changes) {\n        var e_1, _a;\n        this._renderer.beforeUpdate();\n        try {\n            for (var changes_1 = tslib_1.__values(changes), changes_1_1 = changes_1.next(); !changes_1_1.done; changes_1_1 = changes_1.next()) {\n                var _b = tslib_1.__read(changes_1_1.value, 3), x = _b[0], y = _b[1], cell = _b[2];\n                this._renderCell(x, y, cell);\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (changes_1_1 && !changes_1_1.done && (_a = changes_1.return)) _a.call(changes_1);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        this._renderer.afterUpdate();\n    };\n    NoMotionAnimator.prototype.stop = function () {\n        // Nothing to do\n    };\n    NoMotionAnimator.prototype._renderCell = function (x, y, cell) {\n        var e_2, _a;\n        var animationList = [];\n        var start = getTime();\n        if (!cell.revealed && !cell.flagged) {\n            animationList.push({\n                name: 0 /* IDLE */,\n                start: start\n            });\n        }\n        else if (!cell.revealed && cell.flagged) {\n            animationList.push({\n                name: 6 /* FLAGGED */,\n                fadeStart: start - 1000,\n                start: start\n            });\n        }\n        else if (cell.revealed && cell.hasMine) {\n            animationList.push({\n                name: 7 /* MINED */,\n                start: start\n            });\n        }\n        else {\n            animationList.unshift({\n                name: 5 /* NUMBER */,\n                start: start\n            });\n        }\n        if ((cell.revealed &&\n            !cell.hasMine &&\n            cell.touchingMines > 0 &&\n            cell.touchingFlags >= cell.touchingMines) ||\n            (!cell.revealed && cell.flagged)) {\n            animationList.push({\n                name: 3 /* HIGHLIGHT_IN */,\n                fadeStart: start - 1000,\n                start: start\n            });\n        }\n        else {\n            animationList.push({\n                name: 4 /* HIGHLIGHT_OUT */,\n                fadeStart: start - 1000,\n                start: start\n            });\n        }\n        this._renderer.beforeCell(x, y, cell, animationList, start);\n        try {\n            for (var animationList_1 = tslib_1.__values(animationList), animationList_1_1 = animationList_1.next(); !animationList_1_1.done; animationList_1_1 = animationList_1.next()) {\n                var animation = animationList_1_1.value;\n                this._renderer.render(x, y, cell, animation, start);\n            }\n        }\n        catch (e_2_1) { e_2 = { error: e_2_1 }; }\n        finally {\n            try {\n                if (animationList_1_1 && !animationList_1_1.done && (_a = animationList_1.return)) _a.call(animationList_1);\n            }\n            finally { if (e_2) throw e_2.error; }\n        }\n        this._renderer.afterCell(x, y, cell, animationList, start);\n    };\n    return NoMotionAnimator;\n}());\nexport default NoMotionAnimator;\n//# sourceMappingURL=index.js.map"],"names":["NoMotionAnimator","_numTilesX","_numTilesY","_renderer","this","freeze","Object","defineProperty","prototype","get","enumerable","configurable","updateCells","changes","e_1","_a","beforeUpdate","changes_1","tslib_1.__values","changes_1_1","next","done","_b","tslib_1.__read","value","x","y","cell","_renderCell","e_1_1","error","return","call","afterUpdate","stop","e_2","animationList","start","getTime","revealed","flagged","push","name","fadeStart","hasMine","unshift","touchingMines","touchingFlags","beforeCell","animationList_1","animationList_1_1","animation","render","e_2_1","afterCell"],"mappings":"4GAcA,IAAIA,EAAkC,WAClC,SAASA,EAAiBC,EAAYC,EAAYC,GAC9CC,KAAKH,WAAaA,EAClBG,KAAKF,WAAaA,EAClBE,KAAKD,UAAYA,EACjBE,WA6FJ,OA3FAC,OAAOC,eAAeP,EAAiBQ,UAAW,WAAY,CAC1DC,IAAK,WACD,OAAOL,KAAKH,WAAaG,KAAKF,YAElCQ,YAAY,EACZC,cAAc,IAElBX,EAAiBQ,UAAUI,YAAc,SAAUC,GAC/C,IAAIC,EAAKC,EACTX,KAAKD,UAAUa,eACf,IACI,IAAK,IAAIC,EAAYC,WAAiBL,GAAUM,EAAcF,EAAUG,QAASD,EAAYE,KAAMF,EAAcF,EAAUG,OAAQ,CAC/H,IAAIE,EAAKC,SAAeJ,EAAYK,MAAO,GAAIC,EAAIH,EAAG,GAAII,EAAIJ,EAAG,GAAIK,EAAOL,EAAG,GAC/ElB,KAAKwB,YAAYH,EAAGC,EAAGC,IAG/B,MAAOE,GAASf,EAAM,CAAEgB,MAAOD,WAE3B,IACQV,IAAgBA,EAAYE,OAASN,EAAKE,EAAUc,SAAShB,EAAGiB,KAAKf,WAEnE,GAAIH,EAAK,MAAMA,EAAIgB,OAEjC1B,KAAKD,UAAU8B,eAEnBjC,EAAiBQ,UAAU0B,KAAO,aAGlClC,EAAiBQ,UAAUoB,YAAc,SAAUH,EAAGC,EAAGC,GACrD,IAAIQ,EAAKpB,EACLqB,EAAgB,GAChBC,EAAQC,YACPX,EAAKY,UAAaZ,EAAKa,SAMlBb,EAAKY,UAAYZ,EAAKa,QAC5BJ,EAAcK,KAAK,CACfC,KAAM,EACNC,UAAWN,EAAQ,IACnBA,MAAOA,IAGNV,EAAKY,UAAYZ,EAAKiB,QAC3BR,EAAcK,KAAK,CACfC,KAAM,EACNL,MAAOA,IAIXD,EAAcS,QAAQ,CAClBH,KAAM,EACNL,MAAOA,IArBXD,EAAcK,KAAK,CACfC,KAAM,EACNL,MAAOA,IAsBVV,EAAKY,WACLZ,EAAKiB,SACNjB,EAAKmB,cAAgB,GACrBnB,EAAKoB,eAAiBpB,EAAKmB,gBACzBnB,EAAKY,UAAYZ,EAAKa,QACxBJ,EAAcK,KAAK,CACfC,KAAM,EACNC,UAAWN,EAAQ,IACnBA,MAAOA,IAIXD,EAAcK,KAAK,CACfC,KAAM,EACNC,UAAWN,EAAQ,IACnBA,MAAOA,IAGfjC,KAAKD,UAAU6C,WAAWvB,EAAGC,EAAGC,EAAMS,EAAeC,GACrD,IACI,IAAK,IAAIY,EAAkB/B,WAAiBkB,GAAgBc,EAAoBD,EAAgB7B,QAAS8B,EAAkB7B,KAAM6B,EAAoBD,EAAgB7B,OAAQ,CACzK,IAAI+B,EAAYD,EAAkB1B,MAClCpB,KAAKD,UAAUiD,OAAO3B,EAAGC,EAAGC,EAAMwB,EAAWd,IAGrD,MAAOgB,GAASlB,EAAM,CAAEL,MAAOuB,WAE3B,IACQH,IAAsBA,EAAkB7B,OAASN,EAAKkC,EAAgBlB,SAAShB,EAAGiB,KAAKiB,WAErF,GAAId,EAAK,MAAMA,EAAIL,OAEjC1B,KAAKD,UAAUmD,UAAU7B,EAAGC,EAAGC,EAAMS,EAAeC,IAEjDrC"}