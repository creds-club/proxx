{"version":3,"file":"lazy-components-7a5928c9.js","sources":["../src/main/services/preact-canvas/components/board/index.tsx","../src/main/utils/format.ts","../src/main/services/preact-canvas/components/icons/additional.tsx","../src/main/services/preact-canvas/components/top-bar/index.tsx","../src/main/services/preact-canvas/components/win/index.tsx","../src/main/utils/focus-visible.js","../src/main/services/preact-canvas/components/game/index.tsx","../src/main/services/preact-canvas/components/nebula/index.tsx","../src/main/services/preact-canvas/components/nebula/vertex.glsl","../src/main/services/preact-canvas/components/nebula/fragment.glsl","../src/main/services/preact-canvas/components/about/index.tsx","../src/main/services/preact-canvas/components/settings/index.tsx","../src/main/services/preact-canvas/components/showbiz-title/index.tsx"],"sourcesContent":["import * as tslib_1 from \"tslib\";\n/**\n * Copyright 2019 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component, h } from \"preact\";\nimport { putCanvas } from \"src/main/utils/canvas-pool\";\nimport { cellFocusMode } from \"src/main/utils/constants\";\nimport { isFeaturePhone } from \"src/main/utils/static-display\";\nimport { bind } from \"src/utils/bind\";\nimport { board, button as buttonStyle, canvas as canvasStyle, container as containerStyle, gameCell, gameRow, gameTable } from \"./style.css\";\nvar defaultCell = {\n    flagged: false,\n    hasMine: false,\n    revealed: false,\n    touchingFlags: 0,\n    touchingMines: 0\n};\nvar Board = /** @class */ (function (_super) {\n    tslib_1.__extends(Board, _super);\n    function Board() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.state = {\n            keyNavigation: false\n        };\n        _this._buttons = [];\n        _this._additionalButtonData = new WeakMap();\n        return _this;\n    }\n    Board.prototype.componentDidMount = function () {\n        document.documentElement.classList.add(\"in-game\");\n        this._createTable(this.props.width, this.props.height);\n        this.props.gameChangeSubscribe(this._doManualDomHandling);\n        this._rendererInit();\n        this._queryFirstCellRect();\n        this.props.renderer.updateFirstRect(this._firstCellRect);\n        // If the intro was scrolled to the bottom, we need to move it back up again. The nebula\n        // overflows the viewport on devices that hide the URL bar on scroll.\n        window.scrollTo(0, 0);\n        // Set focus on a cell near the center of the board.\n        var x = Math.floor(this.props.width * 0.5);\n        var y = Math.floor(this.props.height * 0.5);\n        var btn = this._buttons[y * this.props.width + x];\n        this.setFocus(btn, { preventScroll: true });\n        // Center scroll position\n        var scroller = this.base.querySelector(\".\" + containerStyle);\n        scroller.scrollLeft = scroller.scrollWidth / 2 - scroller.offsetWidth / 2;\n        scroller.scrollTop = scroller.scrollHeight / 2 - scroller.offsetHeight / 2;\n        window.addEventListener(\"resize\", this._onWindowResize);\n        window.addEventListener(\"keyup\", this._onGlobalKeyUp);\n    };\n    Board.prototype.componentWillUnmount = function () {\n        document.documentElement.classList.remove(\"in-game\");\n        window.removeEventListener(\"resize\", this._onWindowResize);\n        window.removeEventListener(\"keyup\", this._onGlobalKeyUp);\n        this.props.gameChangeUnsubscribe(this._doManualDomHandling);\n        this.props.renderer.stop();\n        this.props.animator.stop();\n        putCanvas(this._canvas);\n    };\n    Board.prototype.shouldComponentUpdate = function () {\n        return false;\n    };\n    Board.prototype.render = function () {\n        var _this = this;\n        return (h(\"div\", { class: board },\n            h(\"div\", { ref: function (el) { return (_this._tableContainer = el); }, class: containerStyle, onScroll: this._onTableScroll, onDblClick: this.onDblClick })));\n    };\n    Board.prototype._onWindowResize = function () {\n        this._onTableScroll();\n        this.props.renderer.onResize();\n    };\n    Board.prototype._onTableScroll = function () {\n        this._queryFirstCellRect();\n        this.props.renderer.updateFirstRect(this._firstCellRect);\n    };\n    Board.prototype._onGlobalKeyUp = function (event) {\n        // This returns the focus to the board when one of these keys is pressed (on feature phones\n        // only). This means the user doesn't have to manually refocus the board.\n        if ((isFeaturePhone || cellFocusMode) &&\n            (event.key === \"9\" ||\n                event.key === \"7\" ||\n                event.key === \"5\" ||\n                event.key === \"0\" ||\n                event.key === \"ArrowLeft\" ||\n                event.key === \"ArrowRight\" ||\n                event.key === \"ArrowUp\" ||\n                event.key === \"ArrowDown\")) {\n            this.moveFocusByKey(event, 0, 0);\n        }\n    };\n    Board.prototype._doManualDomHandling = function (stateChange) {\n        var e_1, _a;\n        if (!stateChange.gridChanges) {\n            return;\n        }\n        try {\n            // Update DOM straight away\n            for (var _b = tslib_1.__values(stateChange.gridChanges), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var _d = tslib_1.__read(_c.value, 3), x = _d[0], y = _d[1], cell = _d[2];\n                var btn = this._buttons[y * this.props.width + x];\n                this._updateButton(btn, cell, x, y);\n            }\n        }\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_1) throw e_1.error; }\n        }\n        this.props.animator.updateCells(stateChange.gridChanges);\n    };\n    Board.prototype._createTable = function (width, height) {\n        var tableContainer = document.querySelector(\".\" + containerStyle);\n        this._table = document.createElement(\"table\");\n        this._table.classList.add(gameTable);\n        this._table.setAttribute(\"role\", \"grid\");\n        this._table.setAttribute(\"aria-label\", \"The game grid\");\n        for (var row = 0; row < height; row++) {\n            var tr = document.createElement(\"tr\");\n            tr.setAttribute(\"role\", \"row\");\n            tr.classList.add(gameRow);\n            for (var col = 0; col < width; col++) {\n                var y = row;\n                var x = col;\n                var td = document.createElement(\"td\");\n                td.setAttribute(\"role\", \"gridcell\");\n                td.classList.add(gameCell);\n                var button = document.createElement(\"button\");\n                button.classList.add(buttonStyle);\n                // A button is made focusable in componentDidMount\n                button.setAttribute(\"tabindex\", \"-1\");\n                button.addEventListener(\"blur\", this.removeFocusVisual);\n                this._additionalButtonData.set(button, [x, y, defaultCell]);\n                this._updateButton(button, defaultCell, x, y);\n                this._buttons.push(button);\n                td.appendChild(button);\n                tr.appendChild(td);\n            }\n            this._table.appendChild(tr);\n        }\n        this._canvas = this.props.renderer.createCanvas();\n        this._canvas.classList.add(canvasStyle);\n        this.base.appendChild(this._canvas);\n        tableContainer.appendChild(this._table);\n        this._table.addEventListener(\"keydown\", this.onKeyDownOnTable);\n        this._table.addEventListener(\"keyup\", this.onKeyUpOnTable);\n        this._table.addEventListener(\"mouseup\", this.onMouseUp);\n        this._table.addEventListener(\"mousedown\", this.onMouseDown);\n        this._table.addEventListener(\"dblclick\", this.onDblClick);\n        this._table.addEventListener(\"contextmenu\", function (event) {\n            return event.preventDefault();\n        });\n        // On feature phone, show focus visual on mouse hover as well\n        // Have to be mousemove on table, instead of mouseenter on buttons to avoid\n        // unwanted focus move on scroll.\n        if (isFeaturePhone || cellFocusMode) {\n            this._table.addEventListener(\"mousemove\", this.moveFocusWithMouse);\n        }\n    };\n    Board.prototype._rendererInit = function () {\n        this.props.renderer.init(this.props.width, this.props.height);\n    };\n    Board.prototype._queryFirstCellRect = function () {\n        this._firstCellRect = this._buttons[0]\n            .closest(\"td\")\n            .getBoundingClientRect();\n    };\n    Board.prototype.removeFocusVisual = function () {\n        this.props.renderer.setFocus(-1, -1);\n    };\n    Board.prototype.setFocusVisual = function (button) {\n        // We only want to render focus styles for keyboard and feature phone users.\n        var showFocusStyle = button.classList.contains(\"focus-visible\") ||\n            isFeaturePhone ||\n            cellFocusMode;\n        if (!showFocusStyle) {\n            this.props.renderer.setFocus(-1, -1);\n            return;\n        }\n        var _a = tslib_1.__read(this._additionalButtonData.get(button), 2), x = _a[0], y = _a[1];\n        this.props.renderer.setFocus(x, y);\n    };\n    Board.prototype.setFocus = function (newFocusBtn, _a) {\n        var _b = (_a === void 0 ? {} : _a).preventScroll, preventScroll = _b === void 0 ? false : _b;\n        // move tab index to targetBtn (necessary for roving tabindex)\n        if (this._currentFocusableBtn) {\n            this._currentFocusableBtn.tabIndex = -1;\n        }\n        newFocusBtn.tabIndex = 0;\n        this._currentFocusableBtn = newFocusBtn;\n        newFocusBtn.focus({ preventScroll: true });\n        if (!preventScroll) {\n            this.scrollBtnIntoView(newFocusBtn);\n        }\n        this.setFocusVisual(newFocusBtn);\n    };\n    Board.prototype.scrollBtnIntoView = function (btn) {\n        // Having to do this manually, as Firefox 48 doesn't support the standard way (boo)\n        var scroller = this._tableContainer;\n        var containerRect = scroller.getBoundingClientRect();\n        var btnRect = btn.getBoundingClientRect();\n        var containerMiddleX = containerRect.width / 2;\n        var containerMiddleY = containerRect.height / 2;\n        var btnMiddleX = btnRect.left + btnRect.width / 2;\n        var btnMiddleY = btnRect.top + btnRect.height / 2;\n        var xDiff = btnMiddleX - containerMiddleX;\n        var yDiff = btnMiddleY - containerMiddleY;\n        scroller.scrollTo({\n            left: scroller.scrollLeft + xDiff,\n            top: scroller.scrollTop + yDiff,\n            behavior: \"smooth\"\n        });\n    };\n    Board.prototype.moveFocusWithMouse = function (event) {\n        // Find if the mouse is on one of the button\n        var targetBtn = event.target;\n        var targetIsBtn = this._additionalButtonData.has(targetBtn);\n        if (!targetIsBtn) {\n            // the mouse is not on a button\n            this.removeFocusVisual();\n            return;\n        }\n        // Locate button that currently have focus\n        var activeBtn = document.activeElement;\n        var activeIsBtn = this._additionalButtonData.has(activeBtn);\n        if (activeIsBtn && activeBtn !== targetBtn) {\n            // If different button has focus, blur the button.\n            activeBtn.blur();\n        }\n        this.setFocus(targetBtn, { preventScroll: true });\n    };\n    Board.prototype.moveFocusByKey = function (event, h, v) {\n        event.stopPropagation();\n        event.preventDefault();\n        // Find which button has focus\n        var currentBtn = document.activeElement;\n        var btnInfo = this._additionalButtonData.get(currentBtn);\n        // If no button has focus, key navigation must have came back to the table.\n        // Focus back on tabindex=0 button first.\n        if (!btnInfo) {\n            this._currentFocusableBtn.focus();\n            btnInfo = this._additionalButtonData.get(this._currentFocusableBtn);\n        }\n        var x = btnInfo[0];\n        var y = btnInfo[1];\n        var width = this.props.width;\n        var height = this.props.height;\n        // move x, y position by passed steps h:horizontal, v:vertical\n        var newX = x + h;\n        var newY = y + v;\n        // Check if [newX, newY] position is out of the game field.\n        if (newX < 0 || newX >= width || (newY < 0 || newY >= height)) {\n            return;\n        }\n        var nextIndex = newX + newY * width;\n        var nextBtn = this._buttons[nextIndex];\n        this.setFocus(nextBtn);\n    };\n    Board.prototype.onKeyUpOnTable = function (event) {\n        if (event.key === \"Tab\") {\n            this.moveFocusByKey(event, 0, 0);\n        }\n    };\n    Board.prototype.onKeyDownOnTable = function (event) {\n        // Since click action is tied to mouseup event,\n        // listen to Enter in case of key navigation click.\n        // Key 8 support is for T9 navigation\n        if (event.key === \"Enter\" || event.key === \"8\") {\n            var button = document.activeElement;\n            if (!button) {\n                return;\n            }\n            event.preventDefault();\n            this.simulateClick(button);\n        }\n        else if (event.key === \"ArrowRight\" || event.key === \"9\") {\n            this.moveFocusByKey(event, 1, 0);\n        }\n        else if (event.key === \"ArrowLeft\" || event.key === \"7\") {\n            this.moveFocusByKey(event, -1, 0);\n        }\n        else if (event.key === \"ArrowUp\" || event.key === \"5\") {\n            this.moveFocusByKey(event, 0, -1);\n        }\n        else if (event.key === \"ArrowDown\" || event.key === \"0\") {\n            this.moveFocusByKey(event, 0, 1);\n        }\n    };\n    // Stopping event is necessary for preventing click event on KaiOS\n    // which moves focus to the mouse and end up clicking two cells,\n    // one under the mouse and one that is currently focused\n    Board.prototype.onMouseUp = function (event) {\n        // hit test if the mouse up was on a button if not, cancel.\n        var targetButton = event.target;\n        var targetButtonData = this._additionalButtonData.get(targetButton);\n        if (!targetButtonData) {\n            return;\n        }\n        event.preventDefault();\n        if (isFeaturePhone || cellFocusMode) {\n            // find currently focused element.\n            var activeButton = document.activeElement;\n            var isActiveBtn = this._additionalButtonData.has(activeButton);\n            if (!isActiveBtn) {\n                // no other butten has focus, so it's safe to focus on mouse\n                this.setFocus(targetButton);\n            }\n            else {\n                // If active button exists, then that button should be clicked.\n                // This is needed for feature phone.\n                targetButton = activeButton;\n            }\n        }\n        if (event.button !== 2) {\n            // normal click\n            this.simulateClick(targetButton);\n            return;\n        }\n        // right (two finger) click\n        this.simulateClick(targetButton, true);\n    };\n    // Same as mouseup, necessary for preventing click event on KaiOS\n    Board.prototype.onMouseDown = function (event) {\n        event.preventDefault();\n    };\n    Board.prototype._toggleDangerMode = function () {\n        this.props.onDangerModeChange(!this.props.dangerMode);\n    };\n    Board.prototype.onDblClick = function (event) {\n        if (event.target === this._tableContainer) {\n            this._toggleDangerMode();\n            return;\n        }\n        var btn = event.target;\n        if (!this._additionalButtonData.has(btn)) {\n            return;\n        }\n        var _a = tslib_1.__read(this._additionalButtonData.get(btn), 3), x = _a[0], y = _a[1], cell = _a[2];\n        if (cell.revealed && cell.touchingMines <= 0) {\n            this._toggleDangerMode();\n            event.stopPropagation();\n        }\n    };\n    Board.prototype.simulateClick = function (button, alt) {\n        if (alt === void 0) { alt = false; }\n        var buttonData = this._additionalButtonData.get(button);\n        this.props.onCellClick(buttonData, alt);\n    };\n    Board.prototype._updateButton = function (btn, cell, x, y) {\n        var cellLabel;\n        if (!cell.revealed) {\n            cellLabel = cell.flagged ? \"flag\" : \"hidden\";\n        }\n        else if (cell.hasMine) {\n            cellLabel = \"black hole\";\n        }\n        else if (cell.touchingMines === 0) {\n            cellLabel = \"blank\";\n        }\n        else {\n            cellLabel = \"\" + cell.touchingMines;\n        }\n        var clickable = !cell.revealed ||\n            (cell.touchingMines && cell.touchingFlags >= cell.touchingMines);\n        btn.setAttribute(\"aria-disabled\", \"\" + !clickable);\n        btn.setAttribute(\"aria-label\", cellLabel);\n        this._additionalButtonData.get(btn)[2] = cell;\n    };\n    tslib_1.__decorate([\n        bind\n    ], Board.prototype, \"_onWindowResize\", null);\n    tslib_1.__decorate([\n        bind\n    ], Board.prototype, \"_onTableScroll\", null);\n    tslib_1.__decorate([\n        bind\n    ], Board.prototype, \"_onGlobalKeyUp\", null);\n    tslib_1.__decorate([\n        bind\n    ], Board.prototype, \"_doManualDomHandling\", null);\n    tslib_1.__decorate([\n        bind\n    ], Board.prototype, \"removeFocusVisual\", null);\n    tslib_1.__decorate([\n        bind\n    ], Board.prototype, \"setFocusVisual\", null);\n    tslib_1.__decorate([\n        bind\n    ], Board.prototype, \"setFocus\", null);\n    tslib_1.__decorate([\n        bind\n    ], Board.prototype, \"moveFocusWithMouse\", null);\n    tslib_1.__decorate([\n        bind\n    ], Board.prototype, \"moveFocusByKey\", null);\n    tslib_1.__decorate([\n        bind\n    ], Board.prototype, \"onKeyUpOnTable\", null);\n    tslib_1.__decorate([\n        bind\n    ], Board.prototype, \"onKeyDownOnTable\", null);\n    tslib_1.__decorate([\n        bind\n    ], Board.prototype, \"onMouseUp\", null);\n    tslib_1.__decorate([\n        bind\n    ], Board.prototype, \"onMouseDown\", null);\n    tslib_1.__decorate([\n        bind\n    ], Board.prototype, \"onDblClick\", null);\n    tslib_1.__decorate([\n        bind\n    ], Board.prototype, \"simulateClick\", null);\n    return Board;\n}(Component));\nexport default Board;\n//# sourceMappingURL=index.js.map","/**\n * Copyright 2019 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport function minSec(ms) {\n    var minutes = Math.floor(ms / (1000 * 60));\n    var seconds = Math.floor((ms / 1000) % 60);\n    var minStr = minutes.toString().padStart(2, \"0\");\n    var secStr = seconds.toString().padStart(2, \"0\");\n    return minStr + \":\" + secStr;\n}\n//# sourceMappingURL=format.js.map","import * as tslib_1 from \"tslib\";\n/**\n * Copyright 2019 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { h } from \"preact\";\nimport { timeIcon, timeIconAnimate, timeIconSvg } from \"./style.css\";\nexport var Timer = function (props) {\n    var _a = props.animate, animate = _a === void 0 ? false : _a, standardProps = tslib_1.__rest(props, [\"animate\"]);\n    return (h(\"div\", tslib_1.__assign({}, standardProps),\n        h(\"div\", { class: timeIcon + \" \" + (animate ? timeIconAnimate : \"\") },\n            h(\"svg\", { class: timeIconSvg, viewBox: \"0 0 24 24\" },\n                h(\"path\", { d: \"M15 1H9v2h6V1zm4 6.4L20.4 6 19 4.6 17.6 6A9 9 0 0 0 3 13c0 5 4 9 9 9a9 9 0 0 0 7-14.6zM12 20c-3.9 0-7-3.1-7-7s3.1-7 7-7 7 3.1 7 7-3.1 7-7 7z\" })))));\n};\nexport var Square = function (props) { return (h(\"svg\", tslib_1.__assign({ viewBox: \"0 0 24 24\" }, props),\n    h(\"circle\", { cx: \"12\", cy: \"12\", r: \"2\" }),\n    h(\"rect\", { width: \"16\", height: \"16\", x: \"4\", y: \"4\", rx: \"2\" }))); };\nexport var Close = function (props) { return (h(\"svg\", tslib_1.__assign({ viewBox: \"0 0 24 24\" }, props),\n    h(\"path\", { d: \"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\" }))); };\nexport var Star = function (props) { return (h(\"svg\", tslib_1.__assign({ viewBox: \"0 0 24 24\" }, props),\n    h(\"path\", { d: \"M22 9.2l-7.2-.6L12 2 9.2 8.6 2 9.2 7.5 14l-1.7 7 6.2-3.7 6.2 3.7-1.6-7L22 9.2zm-10 6.2l-3.8 2.3 1-4.3L6 10.5l4.4-.4 1.7-4 1.7 4 4.4.4-3.3 2.9 1 4.3-3.8-2.3z\" }))); };\nexport var RightClick = function (props) { return (h(\"svg\", tslib_1.__assign({ viewBox: \"0 0 24 24\" }, props),\n    h(\"path\", { d: \"M13 1v8h7a8 8 0 0 0-7-8zM19 12v3a7 7 0 0 1-14 0v-3h14m1-1H4v4a8 8 0 0 0 16 0v-4zM10 2.3V8H5a7 7 0 0 1 5-5.7m1-1.2A8 8 0 0 0 4 9h7V1z\" }))); };\n//# sourceMappingURL=additional.js.map","import * as tslib_1 from \"tslib\";\n/**\n * Copyright 2019 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component, h } from \"preact\";\nimport { minSec } from \"../../../../utils/format\";\nimport { Square, Star, Timer } from \"../icons/additional\";\nimport { squareIcon, squaresLeft, time, timeIcon, title, topBar } from \"./style.css\";\n// Using a sub class to avoid Preact diffing every second.\nvar Time = /** @class */ (function (_super) {\n    tslib_1.__extends(Time, _super);\n    function Time() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Time.prototype.componentDidMount = function () {\n        if (this.props.running) {\n            this._startTimer();\n        }\n    };\n    Time.prototype.componentWillReceiveProps = function (_a) {\n        var running = _a.running;\n        if (running === this.props.running) {\n            return;\n        }\n        if (running) {\n            this._startTimer();\n        }\n        else {\n            this._stopTimer();\n        }\n    };\n    Time.prototype.shouldComponentUpdate = function () {\n        return false;\n    };\n    Time.prototype.componentWillUnmount = function () {\n        this._stopTimer();\n    };\n    Time.prototype.render = function () {\n        return h(\"div\", { role: \"timer\" }, \"00:00\");\n    };\n    Time.prototype._startTimer = function () {\n        var _this = this;\n        this._start = Date.now();\n        this._intervalId = setInterval(function () {\n            requestAnimationFrame(function () {\n                _this.base.textContent = minSec(Date.now() - _this._start);\n            });\n        }, 1000);\n    };\n    Time.prototype._stopTimer = function () {\n        clearInterval(this._intervalId);\n    };\n    return Time;\n}(Component));\nfunction gameStatusText(playMode) {\n    var text;\n    if (playMode === 3 /* Won */) {\n        text = \"You win\";\n    }\n    else if (playMode === 2 /* Lost */) {\n        text = \"Game over\";\n    }\n    else {\n        text = \"Remaining\";\n    }\n    return text;\n}\n// tslint:disable-next-line:max-classes-per-file\nvar TopBar = /** @class */ (function (_super) {\n    tslib_1.__extends(TopBar, _super);\n    function TopBar() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TopBar.prototype.render = function (_a) {\n        var toReveal = _a.toReveal, toRevealTotal = _a.toRevealTotal, timerRunning = _a.timerRunning, playMode = _a.playMode, useMotion = _a.useMotion, bestTime = _a.bestTime, showBestTime = _a.showBestTime;\n        return (h(\"div\", { class: topBar, role: \"banner\" },\n            h(\"h1\", { class: title }, \"Proxx\"),\n            h(\"div\", { class: squaresLeft, \"aria-label\": gameStatusText(playMode) },\n                h(Square, { class: squareIcon }),\n                \" \",\n                toReveal.toString().padStart(toRevealTotal.toString().length, \"0\"),\n                \"/\",\n                toRevealTotal),\n            h(\"div\", { class: time }, showBestTime && bestTime\n                ? [h(\"div\", null, minSec(bestTime)), h(Star, { class: timeIcon })]\n                : [\n                    h(Time, { running: timerRunning }),\n                    h(Timer, { class: timeIcon, animate: timerRunning && useMotion })\n                ])));\n    };\n    return TopBar;\n}(Component));\nexport default TopBar;\n//# sourceMappingURL=index.js.map","import * as tslib_1 from \"tslib\";\n/**\n * Copyright 2019 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component, h } from \"preact\";\nimport { bind } from \"../../../../../utils/bind\";\nimport { minSec } from \"../../../../utils/format\";\nimport { getPresetName } from \"../../../state/grid-presets\";\nimport { Timer } from \"../icons/additional\";\nimport { noMotion, score, scoreRow, time as timeStyle, timeLabel, timerIcon, winInner, winScreen, winSquare, winState } from \"./style.css\";\nvar allowedEmbedderOrigins = [\n    \"https://developer.chrome.com/devsummit/adventure/\",\n    \"https://cds-adventure.firebaseapp.com\",\n    \"https://cds-adventure.web.app\",\n    \"http://snailsfordinner.com\"\n];\nvar End = /** @class */ (function (_super) {\n    tslib_1.__extends(End, _super);\n    function End(props) {\n        var e_1, _a;\n        var _this = _super.call(this, props) || this;\n        var width = props.width, height = props.height, mines = props.mines;\n        var presetName = getPresetName(width, height, mines);\n        _this.state = {\n            gridName: presetName +\n                \" mode\" +\n                (presetName === \"custom\" ? \" - \" + width + \"x\" + height + \":\" + mines : \"\")\n        };\n        if ((presetName === \"hard\" && props.time < 10 * 60 * 1000) ||\n            (presetName === \"medium\" && props.time < 5 * 60 * 1000) ||\n            (presetName === \"easy\" && props.time < 40 * 1000)) {\n            if (window.opener) {\n                try {\n                    for (var allowedEmbedderOrigins_1 = tslib_1.__values(allowedEmbedderOrigins), allowedEmbedderOrigins_1_1 = allowedEmbedderOrigins_1.next(); !allowedEmbedderOrigins_1_1.done; allowedEmbedderOrigins_1_1 = allowedEmbedderOrigins_1.next()) {\n                        var origin_1 = allowedEmbedderOrigins_1_1.value;\n                        window.opener.postMessage({\n                            action: \"game-completed\",\n                            url: \"https://proxx.app/\"\n                        }, origin_1);\n                    }\n                }\n                catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                finally {\n                    try {\n                        if (allowedEmbedderOrigins_1_1 && !allowedEmbedderOrigins_1_1.done && (_a = allowedEmbedderOrigins_1.return)) _a.call(allowedEmbedderOrigins_1);\n                    }\n                    finally { if (e_1) throw e_1.error; }\n                }\n            }\n        }\n        return _this;\n    }\n    End.prototype.componentDidMount = function () {\n        setTimeout(function () {\n            window.scrollTo(0, 0);\n        }, 0);\n        this._playAgainBtn.focus();\n        window.addEventListener(\"keyup\", this.onKeyUp);\n    };\n    End.prototype.componentWillUnmount = function () {\n        window.removeEventListener(\"keyup\", this.onKeyUp);\n    };\n    End.prototype.render = function (_a, _b) {\n        var onRestart = _a.onRestart, onMainMenu = _a.onMainMenu, time = _a.time, bestTime = _a.bestTime, useMotion = _a.useMotion;\n        var gridName = _b.gridName;\n        // const timeStr = minSec(time);\n        var timeStr = time;\n        var bestTimeStr = minSec(bestTime);\n        return (h(\"div\", { class: winScreen },\n            h(\"div\", { class: winInner },\n                h(\"div\", { class: [winSquare, useMotion ? \"\" : noMotion].join(\" \") },\n                    h(\"div\", null,\n                        h(\"div\", null,\n                            h(\"div\", null,\n                                h(\"div\", null,\n                                    h(\"div\", null)))))),\n                h(\"h2\", { class: winState },\n                    time === bestTime ? \"New high score!\" : \"You win!\",\n                    \" \"),\n                h(\"div\", { class: scoreRow },\n                    h(\"div\", { class: score },\n                        h(\"div\", { class: timeLabel }, \"Score\"),\n                        h(\"div\", { class: timeStyle }, timeStr)),\n                    h(Timer, { class: timerIcon }),\n                    h(\"div\", { class: score },\n                        h(\"div\", { class: timeLabel }, \"Best\"),\n                        h(\"div\", { class: timeStyle }, bestTimeStr))))));\n    };\n    End.prototype.onKeyUp = function (event) {\n        if (event.key === \"#\") {\n            this.props.onRestart();\n        }\n        else if (event.key === \"*\") {\n            this.props.onMainMenu();\n        }\n    };\n    tslib_1.__decorate([\n        bind\n    ], End.prototype, \"onKeyUp\", null);\n    return End;\n}(Component));\nexport default End;\n//# sourceMappingURL=index.js.map","/**\r\n * Copied from\r\n * https://github.com/WICG/focus-visible\r\n */\r\n/**\r\n * Copyright 2019 Google Inc. All Rights Reserved.\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nexport default function init() {\r\n  var hadKeyboardEvent = true;\r\n  var hadFocusVisibleRecently = false;\r\n  var hadFocusVisibleRecentlyTimeout = null;\r\n\r\n  var inputTypesWhitelist = {\r\n    text: true,\r\n    search: true,\r\n    url: true,\r\n    tel: true,\r\n    email: true,\r\n    password: true,\r\n    number: true,\r\n    date: true,\r\n    month: true,\r\n    week: true,\r\n    time: true,\r\n    datetime: true,\r\n    \"datetime-local\": true\r\n  };\r\n\r\n  /**\r\n   * Helper function for legacy browsers and iframes which sometimes focus\r\n   * elements like document, body, and non-interactive SVG.\r\n   * @param {Element} el\r\n   */\r\n  function isValidFocusTarget(el) {\r\n    if (\r\n      el &&\r\n      el !== document &&\r\n      el.nodeName !== \"HTML\" &&\r\n      el.nodeName !== \"BODY\" &&\r\n      \"classList\" in el &&\r\n      \"contains\" in el.classList\r\n    ) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Computes whether the given element should automatically trigger the\r\n   * `focus-visible` class being added, i.e. whether it should always match\r\n   * `:focus-visible` when focused.\r\n   * @param {Element} el\r\n   * @return {boolean}\r\n   */\r\n  function focusTriggersKeyboardModality(el) {\r\n    var type = el.type;\r\n    var tagName = el.tagName;\r\n\r\n    if (tagName == \"INPUT\" && inputTypesWhitelist[type] && !el.readOnly) {\r\n      return true;\r\n    }\r\n\r\n    if (tagName == \"TEXTAREA\" && !el.readOnly) {\r\n      return true;\r\n    }\r\n\r\n    if (el.isContentEditable) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Add the `focus-visible` class to the given element if it was not added by\r\n   * the author.\r\n   * @param {Element} el\r\n   */\r\n  function addFocusVisibleClass(el) {\r\n    if (el.classList.contains(\"focus-visible\")) {\r\n      return;\r\n    }\r\n    el.classList.add(\"focus-visible\");\r\n    el.setAttribute(\"data-focus-visible-added\", \"\");\r\n  }\r\n\r\n  /**\r\n   * Remove the `focus-visible` class from the given element if it was not\r\n   * originally added by the author.\r\n   * @param {Element} el\r\n   */\r\n  function removeFocusVisibleClass(el) {\r\n    if (!el.hasAttribute(\"data-focus-visible-added\")) {\r\n      return;\r\n    }\r\n    el.classList.remove(\"focus-visible\");\r\n    el.removeAttribute(\"data-focus-visible-added\");\r\n  }\r\n\r\n  /**\r\n   * Treat `keydown` as a signal that the user is in keyboard modality.\r\n   * Apply `focus-visible` to any current active element and keep track\r\n   * of our keyboard modality state with `hadKeyboardEvent`.\r\n   * @param {Event} e\r\n   */\r\n  function onKeyDown(e) {\r\n    if (isValidFocusTarget(document.activeElement)) {\r\n      addFocusVisibleClass(document.activeElement);\r\n    }\r\n\r\n    hadKeyboardEvent = true;\r\n  }\r\n\r\n  /**\r\n   * If at any point a user clicks with a pointing device, ensure that we change\r\n   * the modality away from keyboard.\r\n   * This avoids the situation where a user presses a key on an already focused\r\n   * element, and then clicks on a different element, focusing it with a\r\n   * pointing device, while we still think we're in keyboard modality.\r\n   * @param {Event} e\r\n   */\r\n  function onPointerDown(e) {\r\n    hadKeyboardEvent = false;\r\n  }\r\n\r\n  /**\r\n   * On `focus`, add the `focus-visible` class to the target if:\r\n   * - the target received focus as a result of keyboard navigation, or\r\n   * - the event target is an element that will likely require interaction\r\n   *   via the keyboard (e.g. a text box)\r\n   * @param {Event} e\r\n   */\r\n  function onFocus(e) {\r\n    // Prevent IE from focusing the document or HTML element.\r\n    if (!isValidFocusTarget(e.target)) {\r\n      return;\r\n    }\r\n\r\n    if (hadKeyboardEvent || focusTriggersKeyboardModality(e.target)) {\r\n      addFocusVisibleClass(e.target);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * On `blur`, remove the `focus-visible` class from the target.\r\n   * @param {Event} e\r\n   */\r\n  function onBlur(e) {\r\n    if (!isValidFocusTarget(e.target)) {\r\n      return;\r\n    }\r\n\r\n    if (\r\n      e.target.classList.contains(\"focus-visible\") ||\r\n      e.target.hasAttribute(\"data-focus-visible-added\")\r\n    ) {\r\n      // To detect a tab/window switch, we look for a blur event followed\r\n      // rapidly by a visibility change.\r\n      // If we don't see a visibility change within 100ms, it's probably a\r\n      // regular focus change.\r\n      hadFocusVisibleRecently = true;\r\n      window.clearTimeout(hadFocusVisibleRecentlyTimeout);\r\n      hadFocusVisibleRecentlyTimeout = window.setTimeout(function () {\r\n        hadFocusVisibleRecently = false;\r\n        window.clearTimeout(hadFocusVisibleRecentlyTimeout);\r\n      }, 100);\r\n      removeFocusVisibleClass(e.target);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * If the user changes tabs, keep track of whether or not the previously\r\n   * focused element had .focus-visible.\r\n   * @param {Event} e\r\n   */\r\n  function onVisibilityChange(e) {\r\n    if (document.visibilityState == \"hidden\") {\r\n      // If the tab becomes active again, the browser will handle calling focus\r\n      // on the element (Safari actually calls it twice).\r\n      // If this tab change caused a blur on an element with focus-visible,\r\n      // re-apply the class when the user switches back to the tab.\r\n      if (hadFocusVisibleRecently) {\r\n        hadKeyboardEvent = true;\r\n      }\r\n      addInitialPointerMoveListeners();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add a group of listeners to detect usage of any pointing devices.\r\n   * These listeners will be added when the polyfill first loads, and anytime\r\n   * the window is blurred, so that they are active when the window regains\r\n   * focus.\r\n   */\r\n  function addInitialPointerMoveListeners() {\r\n    document.addEventListener(\"mousemove\", onInitialPointerMove);\r\n    document.addEventListener(\"mousedown\", onInitialPointerMove);\r\n    document.addEventListener(\"mouseup\", onInitialPointerMove);\r\n    document.addEventListener(\"pointermove\", onInitialPointerMove);\r\n    document.addEventListener(\"pointerdown\", onInitialPointerMove);\r\n    document.addEventListener(\"pointerup\", onInitialPointerMove);\r\n    document.addEventListener(\"touchmove\", onInitialPointerMove);\r\n    document.addEventListener(\"touchstart\", onInitialPointerMove);\r\n    document.addEventListener(\"touchend\", onInitialPointerMove);\r\n  }\r\n\r\n  function removeInitialPointerMoveListeners() {\r\n    document.removeEventListener(\"mousemove\", onInitialPointerMove);\r\n    document.removeEventListener(\"mousedown\", onInitialPointerMove);\r\n    document.removeEventListener(\"mouseup\", onInitialPointerMove);\r\n    document.removeEventListener(\"pointermove\", onInitialPointerMove);\r\n    document.removeEventListener(\"pointerdown\", onInitialPointerMove);\r\n    document.removeEventListener(\"pointerup\", onInitialPointerMove);\r\n    document.removeEventListener(\"touchmove\", onInitialPointerMove);\r\n    document.removeEventListener(\"touchstart\", onInitialPointerMove);\r\n    document.removeEventListener(\"touchend\", onInitialPointerMove);\r\n  }\r\n\r\n  /**\r\n   * When the polfyill first loads, assume the user is in keyboard modality.\r\n   * If any event is received from a pointing device (e.g. mouse, pointer,\r\n   * touch), turn off keyboard modality.\r\n   * This accounts for situations where focus enters the page from the URL bar.\r\n   * @param {Event} e\r\n   */\r\n  function onInitialPointerMove(e) {\r\n    // Work around a Safari quirk that fires a mousemove on <html> whenever the\r\n    // window blurs, even if you're tabbing out of the page. ¯\\_(ツ)_/¯\r\n    if (e.target.nodeName.toLowerCase() === \"html\") {\r\n      return;\r\n    }\r\n\r\n    hadKeyboardEvent = false;\r\n    removeInitialPointerMoveListeners();\r\n  }\r\n\r\n  document.addEventListener(\"keydown\", onKeyDown, true);\r\n  document.addEventListener(\"mousedown\", onPointerDown, true);\r\n  document.addEventListener(\"pointerdown\", onPointerDown, true);\r\n  document.addEventListener(\"touchstart\", onPointerDown, true);\r\n  document.addEventListener(\"focus\", onFocus, true);\r\n  document.addEventListener(\"blur\", onBlur, true);\r\n  document.addEventListener(\"visibilitychange\", onVisibilityChange, true);\r\n  addInitialPointerMoveListeners();\r\n\r\n  document.documentElement.classList.add(\"js-focus-visible\");\r\n}\r\n","import * as tslib_1 from \"tslib\";\nimport { Component, h } from \"preact\";\nimport { submitTime } from \"src/main/services/state/best-times\";\nimport { supportsVibration } from \"src/main/services/state/vibration-preference\";\nimport { vibrationLength } from \"src/main/utils/constants\";\nimport { isFeaturePhone } from \"src/main/utils/static-display\";\nimport { bind } from \"src/utils/bind\";\nimport initFocusHandling from \"../../../../utils/focus-visible\";\nimport Board from \"../board\";\nimport TopBar from \"../top-bar\";\nimport Win from \"../win\";\nimport { againButton, againShortcutKey, exitRow, exitRowInner, game as gameClass, mainButton, shortcutKey } from \"./style.css\";\n// The second this file is loaded, activate focus handling\ninitFocusHandling();\nvar op = window.op;\nvar Game = /** @class */ (function (_super) {\n    tslib_1.__extends(Game, _super);\n    function Game(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = {\n            playMode: 0 /* Pending */,\n            toReveal: props.toRevealTotal,\n            startTime: 0,\n            completeTime: 0,\n            bestTime: 0,\n            computedScore: 0,\n            endTime: 0\n        };\n        _this._init();\n        return _this;\n    }\n    Game.prototype.render = function (_a, _b) {\n        var _this = this;\n        var dangerMode = _a.dangerMode, width = _a.width, height = _a.height, mines = _a.mines, gameChangeSubscribe = _a.gameChangeSubscribe, gameChangeUnsubscribe = _a.gameChangeUnsubscribe, toRevealTotal = _a.toRevealTotal, useMotion = _a.useMotion, previousBestTime = _a.bestTime;\n        var playMode = _b.playMode, toReveal = _b.toReveal, animator = _b.animator, renderer = _b.renderer, completeTime = _b.completeTime, computedScore = _b.computedScore, bestTime = _b.bestTime;\n        var timerRunning = playMode === 1 /* Playing */;\n        return (h(\"div\", { class: gameClass },\n            h(TopBar, { timerRunning: timerRunning, toReveal: toReveal, toRevealTotal: toRevealTotal, playMode: playMode, useMotion: useMotion, bestTime: previousBestTime, showBestTime: playMode === 0 /* Pending */ }),\n            playMode === 3 /* Won */ ? (h(Win, { onMainMenu: this.onReset, onRestart: this.onRestart, time: computedScore, bestTime: bestTime, width: width, height: height, mines: mines, useMotion: this.props.useMotion })) : renderer && animator ? ([\n                h(Board, { width: width, height: height, dangerMode: dangerMode, animator: animator, renderer: renderer, gameChangeSubscribe: gameChangeSubscribe, gameChangeUnsubscribe: gameChangeUnsubscribe, onCellClick: this.onCellClick, onDangerModeChange: this.props.onDangerModeChange }),\n                // playMode === PlayMode.Lost ? (\n                false ? (h(\"div\", { class: exitRow },\n                    h(\"div\", { class: exitRowInner },\n                        h(\"button\", { class: againButton, onClick: this.onRestart, ref: function (el) { return (_this._tryAgainBtn = el); } },\n                            isFeaturePhone && (h(\"span\", { class: [shortcutKey, againShortcutKey].join(\" \") }, \"#\")),\n                            \" \",\n                            \"Try again\"),\n                        h(\"button\", { class: mainButton, onClick: this.onReset },\n                            isFeaturePhone ? h(\"span\", { class: shortcutKey }, \"*\") : \"\",\n                            \" \",\n                            \"Main menu\")))) : (undefined)\n            ]) : (h(\"div\", null))));\n    };\n    Game.prototype.componentDidMount = function () {\n        this.props.gameChangeSubscribe(this.onGameChange);\n        if (!this.props.dangerMode) {\n            this.props.onDangerModeChange(true);\n        }\n        window.addEventListener(\"keyup\", this.onKeyUp);\n    };\n    Game.prototype.componentWillUnmount = function () {\n        this.props.gameChangeUnsubscribe(this.onGameChange);\n        window.removeEventListener(\"keyup\", this.onKeyUp);\n    };\n    Game.prototype.componentDidUpdate = function (_, previousState) {\n        if (this.state.playMode === 2 /* Lost */ &&\n            previousState.playMode !== 2 /* Lost */ &&\n            this._tryAgainBtn) {\n            this._tryAgainBtn.focus();\n            if (this.props.useVibration && supportsVibration) {\n                navigator.vibrate(vibrationLength);\n            }\n        }\n    };\n    Game.prototype._init = function () {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var renderer, animator, _a, RendererClass, AnimatorClass, _b, RendererClass, AnimatorClass;\n            return tslib_1.__generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        if (!this.props.useMotion) return [3 /*break*/, 2];\n                        return [4 /*yield*/, Promise.all([\n                                import(\"src/main/rendering/webgl-renderer\").then(function (m) { return m.default; }),\n                                import(\"src/main/rendering/motion-animator\").then(function (m) { return m.default; })\n                            ])];\n                    case 1:\n                        _a = tslib_1.__read.apply(void 0, [_c.sent(), 2]), RendererClass = _a[0], AnimatorClass = _a[1];\n                        renderer = new RendererClass();\n                        animator = new AnimatorClass(this.props.width, this.props.height, renderer);\n                        return [3 /*break*/, 4];\n                    case 2: return [4 /*yield*/, Promise.all([\n                            import(\"src/main/rendering/canvas-2d-renderer\").then(function (m) { return m.default; }),\n                            import(\"src/main/rendering/no-motion-animator\").then(function (m) { return m.default; })\n                        ])];\n                    case 3:\n                        _b = tslib_1.__read.apply(void 0, [_c.sent(), 2]), RendererClass = _b[0], AnimatorClass = _b[1];\n                        renderer = new RendererClass();\n                        animator = new AnimatorClass(this.props.width, this.props.height, renderer);\n                        _c.label = 4;\n                    case 4:\n                        this.setState({ renderer: renderer, animator: animator });\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Game.prototype.onKeyUp = function (event) {\n        if (event.key === \"#\") {\n            if (this.state.playMode === 2 /* Lost */) {\n                this.onRestart();\n            }\n        }\n        else if (event.key === \"*\") {\n            this.onReset();\n        }\n    };\n    Game.prototype.onReset = function () {\n        this.props.stateService.reset();\n    };\n    Game.prototype.onRestart = function () {\n        this.props.stateService.restart();\n    };\n    Game.prototype.submitScore = function (scoreParam) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var TOUR_ID, score, options, post;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        TOUR_ID = op.getTournamentId();\n                        score = Number(scoreParam);\n                        options = {\n                            tournament_id: TOUR_ID,\n                            metadata: '{\"score\": ' + score + \"}\"\n                        };\n                        console.log(\"options are\", options);\n                        if (!(TOUR_ID !== null)) return [3 /*break*/, 2];\n                        return [4 /*yield*/, op.postScore(options)];\n                    case 1:\n                        post = _a.sent();\n                        if (post.success) {\n                            alert(\"Successfully submitted score \" + score);\n                        }\n                        _a.label = 2;\n                    case 2:\n                        this.refreshPage();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Game.prototype.refreshPage = function () {\n        setTimeout(function () {\n            window.top.postMessage(\"refreshPage\", '*');\n        }, 3000);\n    };\n    Game.prototype.onGameChange = function (gameChange) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var newState, _a;\n            return tslib_1.__generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        newState = {};\n                        if (!(\"playMode\" in gameChange &&\n                            this.state.playMode !== gameChange.playMode)) return [3 /*break*/, 4];\n                        newState.playMode = gameChange.playMode;\n                        if (!(gameChange.playMode === 1 /* Playing */)) return [3 /*break*/, 1];\n                        newState.startTime = Date.now();\n                        return [3 /*break*/, 4];\n                    case 1:\n                        if (!(gameChange.playMode === 3 /* Won */)) return [3 /*break*/, 3];\n                        newState.completeTime = Date.now() - this.state.startTime;\n                        _a = newState;\n                        return [4 /*yield*/, submitTime(this.props.width, this.props.height, this.props.mines, newState.completeTime)];\n                    case 2:\n                        _a.bestTime = _b.sent();\n                        this.props.onDangerModeChange(false);\n                        // compute score from time\n                        newState.computedScore = Number((1000000 / newState.completeTime).toFixed(3));\n                        this.submitScore(newState.computedScore);\n                        return [3 /*break*/, 4];\n                    case 3:\n                        if (gameChange.playMode === 2 /* Lost */) {\n                            this.refreshPage();\n                        }\n                        _b.label = 4;\n                    case 4:\n                        if (\"toReveal\" in gameChange &&\n                            this.state.toReveal !== gameChange.toReveal) {\n                            newState.toReveal = gameChange.toReveal;\n                        }\n                        if (Object.keys(newState).length) {\n                            this.setState(newState);\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Game.prototype.onCellClick = function (cellData, alt) {\n        if (this.state.playMode !== 0 /* Pending */ &&\n            this.state.playMode !== 1 /* Playing */) {\n            return;\n        }\n        var _a = tslib_1.__read(cellData, 3), x = _a[0], y = _a[1], cell = _a[2];\n        var dangerMode = this.props.dangerMode;\n        if (alt) {\n            dangerMode = !dangerMode;\n        }\n        if (!cell.revealed) {\n            if (!dangerMode) {\n                if (cell.flagged) {\n                    this.props.stateService.unflag(x, y);\n                }\n                else {\n                    this.props.stateService.flag(x, y);\n                }\n            }\n            else if (!cell.flagged) {\n                this.props.stateService.reveal(x, y);\n            }\n        }\n        else if (cell.touchingFlags >= cell.touchingMines) {\n            this.props.stateService.revealSurrounding(x, y);\n        }\n    };\n    tslib_1.__decorate([\n        bind\n    ], Game.prototype, \"onKeyUp\", null);\n    tslib_1.__decorate([\n        bind\n    ], Game.prototype, \"onReset\", null);\n    tslib_1.__decorate([\n        bind\n    ], Game.prototype, \"onRestart\", null);\n    tslib_1.__decorate([\n        bind\n    ], Game.prototype, \"onGameChange\", null);\n    tslib_1.__decorate([\n        bind\n    ], Game.prototype, \"onCellClick\", null);\n    return Game;\n}(Component));\nexport default Game;\n//# sourceMappingURL=index.js.map","/**\n * Copyright 2019 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport * as tslib_1 from \"tslib\";\nimport { Component, h } from \"preact\";\nimport { bind } from \"../../../../../utils/bind\";\nimport ShaderBox from \"../../../../utils/shaderbox\";\nimport { nebula as nebulaStyle, nebulaContainer } from \"./style.css\";\nimport { toShaderColor } from \"src/main/rendering/constants\";\nimport toRGB from \"src/main/utils/to-rgb\";\nimport { debug } from \"../../../../utils/constants\";\nimport fragmentShader from \"./fragment.glsl\";\nimport vertexShader from \"./vertex.glsl\";\nvar metaTheme = document.querySelector('meta[name=\"theme-color\"]');\nvar Nebula = /** @class */ (function (_super) {\n    tslib_1.__extends(Nebula, _super);\n    function Nebula() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this._timePeriod = 60000;\n        _this._fadeSpeed = 10;\n        _this._colorBlend = 0;\n        _this._loopRunning = false;\n        _this._prevColors = [];\n        return _this;\n    }\n    Nebula.prototype.componentDidMount = function () {\n        // if no animation mode, skip WebGL setup\n        if (this.props.useMotion) {\n            this._initShaderbox();\n        }\n        window.addEventListener(\"resize\", this._onResize);\n    };\n    Nebula.prototype.shouldComponentUpdate = function (_a) {\n        var colorLight = _a.colorLight, colorDark = _a.colorDark, useMotion = _a.useMotion;\n        if (useMotion !== this.props.useMotion) {\n            return true;\n        }\n        var didLightColorChange = !colorEqual(this.props.colorLight, colorLight);\n        var didDarkColorChange = !colorEqual(this.props.colorDark, colorDark);\n        return didLightColorChange || didDarkColorChange;\n    };\n    Nebula.prototype.componentWillUnmount = function () {\n        this._stop();\n        window.removeEventListener(\"resize\", this._onResize);\n    };\n    Nebula.prototype.componentWillUpdate = function () {\n        if (!this._shaderBox) {\n            return;\n        }\n        this._prevColors = [this.props.colorLight, this.props.colorDark];\n        this._colorBlend = 0;\n    };\n    Nebula.prototype.componentDidUpdate = function (oldProps) {\n        if (this.props.useMotion !== oldProps.useMotion) {\n            if (this.props.useMotion) {\n                this._initShaderbox();\n            }\n            else {\n                this._stop();\n            }\n        }\n        this._updateColors();\n    };\n    Nebula.prototype.render = function (_a) {\n        var colorLight = _a.colorLight, colorDark = _a.colorDark, useMotion = _a.useMotion;\n        return (h(\"div\", { class: nebulaContainer, style: \"background: linear-gradient(to bottom, \" + toRGB(colorLight) + \", \" + toRGB(colorDark) }, useMotion && h(\"canvas\", { class: nebulaStyle, \"aria-hidden\": \"true\" })));\n    };\n    Nebula.prototype._initShaderbox = function () {\n        var _this = this;\n        this._shaderBox = new ShaderBox(vertexShader, fragmentShader, {\n            canvas: this.base.querySelector(\"canvas\"),\n            scaling: 1 / 5,\n            antialias: false,\n            alpha: false,\n            uniforms: [\n                \"alt_color\",\n                \"time\",\n                \"nebula_movement_range\",\n                \"nebula_zoom\",\n                \"vortex_strength\",\n                \"circle1_offset\",\n                \"circle2_offset\",\n                \"circle3_offset\",\n                \"alt_color_dark\",\n                \"alt_color_light\",\n                \"main_color_dark\",\n                \"main_color_light\"\n            ]\n        });\n        this._shaderBox.setUniform1f(\"alt_color\", 0);\n        this._shaderBox.setUniform1f(\"nebula_movement_range\", 2);\n        this._shaderBox.setUniform1f(\"nebula_zoom\", 0.5);\n        this._shaderBox.setUniform1f(\"vortex_strength\", 0.1);\n        this._shaderBox.setUniform1f(\"circle1_offset\", 0);\n        this._shaderBox.setUniform1f(\"circle2_offset\", 1.4);\n        this._shaderBox.setUniform1f(\"circle3_offset\", 0);\n        this._onResize();\n        this._prevColors = [this.props.colorLight, this.props.colorDark];\n        this._updateColors();\n        this._start();\n        if (debug) {\n            import(\"src/main/services/debug\").then(function (m) {\n                return m.nebula(_this, _this._shaderBox);\n            });\n        }\n    };\n    Nebula.prototype._updateColors = function () {\n        var colorDark = this.props.colorDark;\n        metaTheme.setAttribute(\"content\", \"rgb(\" + colorDark[0] + \", \" + colorDark[1] + \", \" + colorDark[2] + \")\");\n        if (!this._shaderBox) {\n            return;\n        }\n        this._shaderBox.setUniform4f(\"main_color_light\", toShaderColor(this._prevColors[0]));\n        this._shaderBox.setUniform4f(\"main_color_dark\", toShaderColor(this._prevColors[1]));\n        this._shaderBox.setUniform4f(\"alt_color_light\", toShaderColor(this.props.colorLight));\n        this._shaderBox.setUniform4f(\"alt_color_dark\", toShaderColor(colorDark));\n    };\n    Nebula.prototype._start = function () {\n        if (this._loopRunning) {\n            return;\n        }\n        this._loopRunning = true;\n        requestAnimationFrame(this._loop);\n    };\n    Nebula.prototype._stop = function () {\n        this._loopRunning = false;\n    };\n    Nebula.prototype._onResize = function () {\n        if (!this._shaderBox) {\n            return;\n        }\n        this._shaderBox.resize();\n    };\n    Nebula.prototype._loop = function (ts) {\n        this._shaderBox.setUniform1f(\"time\", (ts % this._timePeriod) / this._timePeriod);\n        this._colorBlend += (1 - this._colorBlend) / this._fadeSpeed;\n        this._shaderBox.setUniform1f(\"alt_color\", this._colorBlend);\n        this._shaderBox.draw();\n        if (this._loopRunning) {\n            requestAnimationFrame(this._loop);\n        }\n    };\n    tslib_1.__decorate([\n        bind\n    ], Nebula.prototype, \"_onResize\", null);\n    tslib_1.__decorate([\n        bind\n    ], Nebula.prototype, \"_loop\", null);\n    return Nebula;\n}(Component));\nexport default Nebula;\nfunction colorEqual(c1, c2) {\n    return c1[0] === c2[0] && c1[1] === c2[1] && c1[2] === c2[2];\n}\n//# sourceMappingURL=index.js.map","export default \"\\n#version 100\\nprecision highp float;attribute vec2 pos;varying vec2 uv;void main(){gl_Position=vec4(pos,0.0,1.0);uv=pos/2.0+0.5;}\";","export default \"\\n#version 100\\nprecision mediump float;varying vec2 uv;uniform vec2 iResolution;uniform vec4 alt_color_dark;uniform vec4 alt_color_light;uniform vec4 main_color_dark;uniform vec4 main_color_light;uniform float time;uniform float alt_color;uniform float nebula_movement_range;uniform float nebula_zoom;uniform float vortex_strength;uniform float circle1_offset;uniform float circle2_offset;uniform float circle3_offset;\\n#define PI 3.14159\\n\\n#define remap(minIn, maxIn, minOut, maxOut, v) (((v) - (minIn)) / ((maxIn) - (minIn)) * ((maxOut) - (minOut)) + (minOut))\\nfloat a(vec2 b){return fract(sin(dot(b.xy,vec2(12.9898,78.233)))*3.233);}float c(float d){if(d==0.0||d==1.0){return d;}if((d*=2.0)<1.0){return 0.5*pow(2.0,10.0*(d-1.0));}else{return 0.5*(-pow(2.0,-10.0*(d-1.0))+2.0);}}float e(vec2 b){vec2 f=floor(b);vec2 g=fract(b);float h=a(f);float i=a(f+vec2(1.0,0.0));float j=a(f+vec2(0.0,1.0));float k=a(f+vec2(1.0,1.0));vec2 l=g;l=smoothstep(0.,1.,g);return mix(h,i,l.x)+(j-h)*l.y*(1.0-l.x)+(k-i)*l.x*l.y;}\\n#define NUM_OCTAVES 1\\nfloat m(vec2 b){float n=0.0;float o=1.;float p=2.0;float q=0.5;for(int f=0;f<NUM_OCTAVES;f++){n+=o*e(b);b*=p;o*=q;}return n;}vec2 r(vec2 s,vec2 j){vec2 k=s-j;return vec2(k.y,-k.x)/(length(k)+0.05);}void main(){vec4 t=vec4(vec3(0.),1.);vec4 u=vec4(1.);vec2 v=(uv-vec2(.5))/.5;v=v*iResolution/min(iResolution.x,iResolution.y);vec4 w;{vec2 x=v;for(int f=0;f<5;f++){x+=r(x,vec2(0.))*vortex_strength;}float y=sin(time*2.*PI);float g=m(x*nebula_zoom+vec2(y*nebula_movement_range*nebula_zoom,0.0));w=mix(mix(main_color_dark,alt_color_dark,alt_color),mix(main_color_light,alt_color_light,alt_color),c(g));}vec4 z=vec4(.0);{float A=.2;vec2 B=vec2(1,-1.);vec2 C=vec2(.2,-.4);float D=sin(time*2.*PI+circle1_offset)*PI/4.;mat2 E=mat2(cos(D),sin(D),-sin(D),cos(D));vec2 x=v-C;x=E*(x-B)+B;float k=length(x)-A;float F=(1.-smoothstep(0.,0.01,k));z=clamp(z+mix(t,alt_color_light*.1,F),vec4(0.),vec4(1.));}{float A=.3;vec2 B=vec2(0.,-3.);vec2 C=vec2(-.2,.3);float D=sin(time*2.*PI+circle2_offset)*PI/4.;mat2 E=mat2(cos(D),sin(D),-sin(D),cos(D));vec2 x=v-C;x=E*(x-B)+B;float k=length(x)-A;float F=(1.-smoothstep(0.,0.01,k));z=clamp(z+mix(t,alt_color_light*.1,F),vec4(0.),vec4(1.));}{float A=.1;vec2 B=vec2(-1.,2.);vec2 C=vec2(-1.,.6);float D=sin(time*2.*PI+circle3_offset)*PI/4.;mat2 E=mat2(cos(D),sin(D),-sin(D),cos(D));vec2 x=v-C;x=E*(x-B)+B;float k=length(x)-A;float F=(1.-smoothstep(0.,0.01,k));z=clamp(z+mix(t,alt_color_light*.1,F),vec4(0.),vec4(1.));}gl_FragColor=vec4(vec3(1.)-(vec3(1.)-w.rgb)*(vec3(1.)-z.rgb),1.);}\";","import * as tslib_1 from \"tslib\";\n/**\n * Copyright 2019 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport version from \"consts:version\";\nimport { Component, h } from \"preact\";\nimport { idleAnimationTextureDrawer, staticTextureDrawer } from \"src/main/rendering/animation\";\nimport { turquoise } from \"src/main/rendering/constants\";\nimport { getCellSizes } from \"src/main/utils/cell-sizing\";\nimport { bind } from \"src/utils/bind\";\nimport { isFeaturePhone, staticDevicePixelRatio } from \"../../../../utils/static-display\";\nimport { RightClick } from \"../icons/additional\";\nimport { aboutWrapper as aboutWrapperStyle, iconGuideItem, iconGuideRow, shortcutIcon as shortcutIconStyle, shortcutKey as shortcutKeyStyle, shortcutList as shortcutListStyle, systemData as systemDataStyle, tile as tileStyle } from \"./style.css\";\nvar navigator;\nnavigator = window.navigator;\nvar About = /** @class */ (function (_super) {\n    tslib_1.__extends(About, _super);\n    function About() {\n        var _this = _super.call(this) || this;\n        var _a = getCellSizes(), cellPadding = _a.cellPadding, cellSize = _a.cellSize;\n        _this._tileSize = (cellSize + 2 * cellPadding) * staticDevicePixelRatio;\n        return _this;\n    }\n    About.prototype.render = function () {\n        return (h(\"div\", { class: aboutWrapperStyle },\n            h(\"h1\", null, \"How to play\"),\n            h(\"div\", { class: iconGuideRow },\n                h(\"div\", { class: iconGuideItem },\n                    h(\"canvas\", { class: tileStyle, ref: this._renderCanvas, width: this._tileSize, height: this._tileSize, \"data-sprite\": \"idle\", \"data-frame\": \"0\", \"data-highlight\": \"false\", \"data-border\": \"true\", \"data-circle\": \"true\", \"data-dot\": \"false\" }),\n                    \"Unrevealed\"),\n                h(\"div\", { class: iconGuideItem },\n                    h(\"canvas\", { class: tileStyle, ref: this._renderCanvas, width: this._tileSize, height: this._tileSize, \"data-sprite\": \"static\", \"data-frame\": 10 /* MINE */.toString(), \"data-highlight\": \"false\", \"data-border\": \"false\", \"data-circle\": \"false\", \"data-dot\": \"false\" }),\n                    \"Black hole\")),\n            h(\"p\", null,\n                \"An unrevealed tile might have a black hole behind it, it might not. The idea is to clear all the tiles that \",\n                h(\"strong\", null, \"don't\"),\n                \" have black holes behind them.\"),\n            h(\"p\", null, \"But, the thing about a black hole \\u2013 its main distinguishing feature \\u2013 is it's black. And the thing about space, the color of space, your basic space color, is black. So how are you supposed to avoid them? Here's how:\"),\n            h(\"div\", { class: iconGuideRow },\n                h(\"div\", { class: iconGuideItem },\n                    h(\"canvas\", { class: tileStyle, ref: this._renderCanvas, width: this._tileSize, height: this._tileSize, \"data-sprite\": \"none\", \"data-frame\": \"0\", \"data-highlight\": \"false\", \"data-border\": \"true\", \"data-circle\": \"false\" }),\n                    \"Cleared\"),\n                h(\"div\", { class: iconGuideItem },\n                    h(\"canvas\", { class: tileStyle, ref: this._renderCanvas, width: this._tileSize, height: this._tileSize, \"data-sprite\": \"static\", \"data-frame\": 1 /* NUMBER_1 */.toString(), \"data-highlight\": \"false\", \"data-border\": \"false\", \"data-circle\": \"false\", \"data-dot\": \"false\" }),\n                    \"Clue\")),\n            h(\"p\", null,\n                \"If you avoid a black hole, the number tells you how many of the 8 surrounding tiles are a black hole. If it's blank,\",\n                \" \",\n                h(\"strong\", null, \"none\"),\n                \" of the surrounding tiles is a black hole.\"),\n            h(\"p\", null, \"If you think you know where a black hole is, flag it!\"),\n            h(\"div\", { class: iconGuideRow },\n                h(\"div\", { class: iconGuideItem },\n                    h(\"canvas\", { class: tileStyle, ref: this._renderCanvas, width: this._tileSize, height: this._tileSize, \"data-sprite\": \"idle\", \"data-frame\": \"0\", \"data-highlight\": \"true\", \"data-border\": \"true\", \"data-circle\": \"true\", \"data-dot\": \"true\" }),\n                    \"Flagged\"),\n                h(\"div\", { class: iconGuideItem },\n                    h(\"canvas\", { class: tileStyle, ref: this._renderCanvas, width: this._tileSize, height: this._tileSize, \"data-sprite\": \"static\", \"data-frame\": 1 /* NUMBER_1 */.toString(), \"data-highlight\": \"true\", \"data-border\": \"false\", \"data-circle\": \"false\", \"data-dot\": \"false\" }),\n                    \"Active clue\")),\n            h(\"p\", null, \"Switch into flag mode, and tap the suspected tile. Once you've flagged enough tiles around a clue, it'll become active. Tap an active clue to clear all the non-flagged tiles around it.\"),\n            h(\"h1\", null, \"Shortcuts\"),\n            isFeaturePhone ? (h(\"ul\", { class: shortcutListStyle },\n                h(\"li\", null,\n                    h(\"span\", { class: shortcutKeyStyle, \"aria-label\": \"5 key\" }, \"5\"),\n                    \"Move up\"),\n                h(\"li\", null,\n                    h(\"span\", { class: shortcutKeyStyle, \"aria-label\": \"0 key\" }, \"0\"),\n                    \"Move down\"),\n                h(\"li\", null,\n                    h(\"span\", { class: shortcutKeyStyle, \"aria-label\": \"7 key\" }, \"7\"),\n                    \"Move left\"),\n                h(\"li\", null,\n                    h(\"span\", { class: shortcutKeyStyle, \"aria-label\": \"9 key\" }, \"9\"),\n                    \"Move right\"),\n                h(\"li\", null,\n                    h(\"span\", { class: shortcutKeyStyle, \"aria-label\": \"8 key\" }, \"8\"),\n                    \"Click the highlighted cell\"),\n                h(\"li\", null,\n                    h(\"span\", { class: shortcutKeyStyle, \"aria-label\": \"# key\" }, \"#\"),\n                    \"Switch between Clear and Flag mode\"))) : (h(\"ul\", { class: shortcutListStyle },\n                h(\"li\", null,\n                    h(\"span\", { class: shortcutKeyStyle, \"aria-label\": \"f key\" }, \"F\"),\n                    \"Switch between Clear and Flag mode\"),\n                h(\"li\", null,\n                    h(RightClick, { class: shortcutIconStyle, \"aria-label\": \"Right click\" }),\n                    \"Flag when in clear mode, or clear when in flag mode.\"))),\n            h(\"h1\", null, \"GitHub\"),\n            h(\"p\", null,\n                \"Source code can be found at our\",\n                \" \",\n                h(\"a\", { href: \"https://github.com/GoogleChromeLabs/proxx\" }, \"GitHub repository\"),\n                \".\"),\n            h(\"h1\", null, \"Privacy policy\"),\n            h(\"p\", null,\n                \"Google Analytics is used to record\",\n                \" \",\n                h(\"a\", { href: \"https://support.google.com/analytics/answer/6004245?ref_topic=2919631\" }, \"basic visit data\"),\n                \". Highscores and your user preference are saved locally. No additional data is sent to the server.\"),\n            h(\"h1\", null, \"Credit\"),\n            h(\"p\", null, \"Built by Google Chrome Labs\"),\n            h(\"p\", null,\n                \"Thanks to \",\n                h(\"a\", { href: \"https://www.tokyo-wolf.com/\" }, \"Tokyo Wolf\"),\n                \" for the visual design concept.\"),\n            h(\"h1\", null, \"System Information\"),\n            h(\"ul\", { class: systemDataStyle },\n                h(\"li\", null,\n                    \"Version: \",\n                    version),\n                h(\"li\", null,\n                    \"Motion: \",\n                    this.props.motion ? \"true\" : \"false\"),\n                h(\"li\", null,\n                    \"Supports WebGL:\",\n                    \" \",\n                    this.props.supportsSufficientWebGL ? \"true\" : \"false\"),\n                h(\"li\", null,\n                    \"Feature Phone: \",\n                    isFeaturePhone ? \"yes\" : \"no\"),\n                h(\"li\", null,\n                    \"Standalone Mode:\",\n                    \" \",\n                    window.matchMedia(\"(display-mode: standalone)\").matches\n                        ? \"yes\"\n                        : \"no\"),\n                h(\"li\", null,\n                    \"Screen Width: \",\n                    window.innerWidth,\n                    \"px\"),\n                h(\"li\", null,\n                    \"Screen Height: \",\n                    window.innerHeight,\n                    \"px\"),\n                h(\"li\", null,\n                    \"DPR: \",\n                    staticDevicePixelRatio),\n                h(\"li\", null,\n                    \"Device Memory: \",\n                    navigator.deviceMemory),\n                h(\"li\", null,\n                    \"Concurrency: \",\n                    navigator.hardwareConcurrency),\n                h(\"li\", null,\n                    \"UA: \",\n                    navigator.userAgent))));\n    };\n    About.prototype._renderCanvas = function (canvas) {\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\n            var spriteName, drawer, ctx, frame, hasBorder, hasCircle, hasDot, hasHighlight;\n            return tslib_1.__generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.props.texturePromise];\n                    case 1:\n                        _a.sent();\n                        spriteName = canvas.dataset.sprite;\n                        drawer = null;\n                        switch (spriteName) {\n                            case \"idle\":\n                                drawer = idleAnimationTextureDrawer;\n                                break;\n                            case \"static\":\n                                drawer = staticTextureDrawer;\n                                break;\n                        }\n                        ctx = canvas.getContext(\"2d\");\n                        ctx.save();\n                        if (drawer) {\n                            frame = Number(canvas.dataset.frame);\n                            drawer(frame, ctx, this._tileSize);\n                        }\n                        hasBorder = canvas.dataset.border.toLowerCase() === \"true\";\n                        if (hasBorder) {\n                            staticTextureDrawer(0 /* OUTLINE */, ctx, this._tileSize);\n                        }\n                        hasCircle = canvas.dataset.circle.toLowerCase() === \"true\";\n                        if (hasCircle) {\n                            staticTextureDrawer(12 /* INNER_CIRCLE */, ctx, this._tileSize);\n                        }\n                        hasDot = canvas.dataset.dot.toLowerCase() === \"true\";\n                        if (hasDot) {\n                            staticTextureDrawer(13 /* DOT */, ctx, this._tileSize);\n                        }\n                        hasHighlight = canvas.dataset.highlight.toLowerCase() === \"true\";\n                        if (hasHighlight) {\n                            ctx.globalCompositeOperation = \"source-atop\";\n                            ctx.fillStyle = turquoise;\n                            ctx.fillRect(0, 0, this._tileSize, this._tileSize);\n                        }\n                        ctx.restore();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    tslib_1.__decorate([\n        bind\n    ], About.prototype, \"_renderCanvas\", null);\n    return About;\n}(Component));\nexport default About;\n//# sourceMappingURL=index.js.map","import * as tslib_1 from \"tslib\";\n/**\n * Copyright 2019 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component, h } from \"preact\";\nimport { isFeaturePhone } from \"src/main/utils/static-display\";\nimport { bind } from \"src/utils/bind\";\nimport { supportsVibration } from \"../../../state/vibration-preference\";\nimport About from \"../about\";\nimport { Close } from \"../icons/additional\";\nimport { buttonOff as btnOffStyle, buttonOn as btnOnStyle, closeButton as closebtnStyle, closeContainer as closeContainerStyle, fpCloseButton as fpCloseBtnStyle, fpCloseContainer as fpCloseContainerStyle, keyshortcut as keyshortcutStyle, settings as settingsStyle, settingsContent as settingsContentStyle, settingsWindow as settingsWindowStyle } from \"./style.css\";\nvar Settings = /** @class */ (function (_super) {\n    tslib_1.__extends(Settings, _super);\n    function Settings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Settings.prototype.render = function (_a) {\n        var _this = this;\n        var onCloseClicked = _a.onCloseClicked, onMotionPrefChange = _a.onMotionPrefChange, motion = _a.motion, texturePromise = _a.texturePromise, supportsSufficientWebGL = _a.supportsSufficientWebGL, disableAnimationBtn = _a.disableAnimationBtn, useVibration = _a.useVibration, onVibrationPrefChange = _a.onVibrationPrefChange;\n        var closeBtn = isFeaturePhone ? (h(\"button\", { \"aria-label\": \"close button\", ref: function (focusItem) { return (_this.focusItem = focusItem); }, class: fpCloseBtnStyle, onClick: onCloseClicked },\n            h(\"span\", { class: keyshortcutStyle }, \"*\"),\n            \" close\")) : (h(\"button\", { \"aria-label\": \"close button\", ref: function (focusItem) { return (_this.focusItem = focusItem); }, class: closebtnStyle, onClick: onCloseClicked },\n            h(Close, null)));\n        return (h(\"div\", { role: \"dialog\", \"aria-label\": \"settings dialog\", class: settingsStyle },\n            h(\"div\", { class: isFeaturePhone ? fpCloseContainerStyle : closeContainerStyle }, closeBtn),\n            h(\"div\", { class: settingsWindowStyle },\n                h(\"div\", { class: settingsContentStyle },\n                    h(\"h1\", null, \"Settings\"),\n                    h(\"button\", { class: motion ? btnOnStyle : btnOffStyle, onClick: onMotionPrefChange, disabled: disableAnimationBtn },\n                        \"Animations \",\n                        motion ? \"on\" : \"off\"),\n                    h(\"button\", { class: useVibration ? btnOnStyle : btnOffStyle, onClick: onVibrationPrefChange, disabled: !supportsVibration },\n                        \"Vibrate \",\n                        useVibration ? \"on\" : \"off\"),\n                    h(About, { motion: motion, texturePromise: texturePromise, supportsSufficientWebGL: supportsSufficientWebGL })))));\n    };\n    Settings.prototype.componentDidMount = function () {\n        window.scrollTo(0, 0);\n        this.focusItem.focus();\n        window.addEventListener(\"keyup\", this._onKeyUp);\n    };\n    Settings.prototype.componentWillUnmount = function () {\n        window.removeEventListener(\"keyup\", this._onKeyUp);\n    };\n    Settings.prototype._onKeyUp = function (event) {\n        if (event.key === \"Escape\" || event.key === \"*\") {\n            this.props.onCloseClicked();\n        }\n    };\n    tslib_1.__decorate([\n        bind\n    ], Settings.prototype, \"_onKeyUp\", null);\n    return Settings;\n}(Component));\nexport default Settings;\n//# sourceMappingURL=index.js.map","import * as tslib_1 from \"tslib\";\n/**\n * Copyright 2019 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Component, h } from \"preact\";\nimport { animate as animateStyle, cell, cellInner, columnContainer, innerSquareColumn, innerSquareFlash, innerSquareItem, innerSquareOutline, innerSquareSizer, row, showbizTitle, showbizTitleFrame } from \"./style.css\";\nvar title = \"PR0XX\";\nfunction removeRandom(arr) {\n    return arr.splice(Math.floor(Math.random() * arr.length), 1)[0];\n}\nfunction createNumberItems() {\n    var numbers = Array(8)\n        .fill(null)\n        .map(function (_, i) { return i + 1; });\n    return Array(8)\n        .fill(null)\n        .map(function () { return (h(\"div\", { class: innerSquareSizer },\n        h(\"div\", { class: innerSquareItem }, removeRandom(numbers)))); });\n}\nvar columns = tslib_1.__spread(title).map(function (letter) { return (h(\"div\", { class: columnContainer },\n    h(\"div\", { class: innerSquareColumn },\n        h(\"div\", { class: innerSquareSizer },\n            h(\"div\", { class: innerSquareItem }, letter)),\n        createNumberItems()))); });\n// tslint:disable-next-line:max-classes-per-file\nvar ShowbizTitle = /** @class */ (function (_super) {\n    tslib_1.__extends(ShowbizTitle, _super);\n    function ShowbizTitle() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    ShowbizTitle.prototype.shouldComponentUpdate = function (nextProps) {\n        return this.props.motion !== nextProps.motion;\n    };\n    ShowbizTitle.prototype.componentDidMount = function () {\n        var e_1, _a, e_2, _b;\n        // Random numbers -> PR0XX\n        var oneIteration = 266;\n        var untilFirstReveal = 2000;\n        var untilNextReveal = 70;\n        var middleInners = tslib_1.__spread(this.base.querySelectorAll(\".\" + cellInner));\n        var indexLeft = 2;\n        var indexRight = 2;\n        var time = untilFirstReveal;\n        var flashHeight = 600;\n        while (indexLeft >= 0) {\n            try {\n                for (var _c = (e_1 = void 0, tslib_1.__values(new Set([indexLeft, indexRight]))), _d = _c.next(); !_d.done; _d = _c.next()) {\n                    var innerIndex = _d.value;\n                    var inner = middleInners[innerIndex];\n                    inner.querySelector(\".\" + innerSquareColumn).style.animationIterationCount =\n                        time / oneIteration + \"\";\n                    var flash = inner.querySelector(\".\" + innerSquareFlash);\n                    flash.style.animationDelay = time + \"ms\";\n                    flash.style.height = flashHeight + \"%\";\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n            indexLeft--;\n            indexRight++;\n            flashHeight /= 1.5;\n            time += untilNextReveal;\n        }\n        // Circles\n        time += 500;\n        indexLeft = 2;\n        indexRight = 2;\n        while (indexLeft >= 0) {\n            try {\n                for (var _e = (e_2 = void 0, tslib_1.__values(new Set([indexLeft, indexRight]))), _f = _e.next(); !_f.done; _f = _e.next()) {\n                    var index = _f.value;\n                    var inner = middleInners[index];\n                    inner.querySelector(\".\" + innerSquareOutline).style.animationDelay = time + \"ms\";\n                }\n            }\n            catch (e_2_1) { e_2 = { error: e_2_1 }; }\n            finally {\n                try {\n                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\n                }\n                finally { if (e_2) throw e_2.error; }\n            }\n            indexLeft--;\n            indexRight++;\n            time += 150;\n        }\n    };\n    ShowbizTitle.prototype.render = function (_a, _s) {\n        var motion = _a.motion;\n        return (h(\"div\", { class: showbizTitle + \" \" + (motion ? animateStyle : \"\"), role: \"heading\", \"aria-label\": \"PROXX\" },\n            h(\"div\", { class: showbizTitleFrame, \"aria-hidden\": \"true\" },\n                h(\"div\", { class: row }, tslib_1.__spread(title).map(function (_, i) { return (h(\"div\", { class: cell },\n                    h(\"div\", { class: cellInner },\n                        columns[i],\n                        h(\"div\", { class: innerSquareOutline }),\n                        h(\"div\", { class: innerSquareFlash })))); })))));\n    };\n    return ShowbizTitle;\n}(Component));\nexport default ShowbizTitle;\n//# sourceMappingURL=index.js.map"],"names":["defaultCell","flagged","hasMine","revealed","touchingFlags","touchingMines","Board","_super","_this","apply","this","arguments","state","keyNavigation","_buttons","_additionalButtonData","WeakMap","tslib_1.__extends","prototype","componentDidMount","document","documentElement","classList","add","_createTable","props","width","height","gameChangeSubscribe","_doManualDomHandling","_rendererInit","_queryFirstCellRect","renderer","updateFirstRect","_firstCellRect","window","scrollTo","x","Math","floor","y","btn","setFocus","preventScroll","scroller","base","querySelector","scrollLeft","scrollWidth","offsetWidth","scrollTop","scrollHeight","offsetHeight","addEventListener","_onWindowResize","_onGlobalKeyUp","componentWillUnmount","remove","removeEventListener","gameChangeUnsubscribe","stop","animator","putCanvas","_canvas","shouldComponentUpdate","render","h","class","ref","el","_tableContainer","onScroll","_onTableScroll","onDblClick","onResize","event","isFeaturePhone","cellFocusMode","key","moveFocusByKey","stateChange","e_1","_a","gridChanges","_b","tslib_1.__values","_c","next","done","_d","tslib_1.__read","value","cell","_updateButton","e_1_1","error","return","call","updateCells","tableContainer","_table","createElement","setAttribute","row","tr","col","td","button","removeFocusVisual","set","push","appendChild","createCanvas","onKeyDownOnTable","onKeyUpOnTable","onMouseUp","onMouseDown","preventDefault","moveFocusWithMouse","init","closest","getBoundingClientRect","setFocusVisual","contains","get","newFocusBtn","_currentFocusableBtn","tabIndex","focus","scrollBtnIntoView","containerRect","btnRect","containerMiddleX","containerMiddleY","xDiff","left","yDiff","top","behavior","targetBtn","target","has","activeBtn","activeElement","blur","v","stopPropagation","currentBtn","btnInfo","newX","newY","nextIndex","nextBtn","simulateClick","targetButton","activeButton","_toggleDangerMode","onDangerModeChange","dangerMode","alt","buttonData","onCellClick","cellLabel","clickable","tslib_1.__decorate","bind","Component","minSec","ms","minutes","seconds","toString","padStart","Timer","animate","standardProps","tslib_1.__rest","tslib_1.__assign","timeIcon","viewBox","d","Square","cx","cy","r","rx","Close","Star","RightClick","Time","running","_startTimer","componentWillReceiveProps","_stopTimer","role","_start","Date","now","_intervalId","setInterval","requestAnimationFrame","textContent","clearInterval","gameStatusText","playMode","TopBar","toReveal","toRevealTotal","timerRunning","useMotion","bestTime","showBestTime","topBar","title","squaresLeft","aria-label","squareIcon","length","time","allowedEmbedderOrigins","End","mines","presetName","getPresetName","gridName","opener","allowedEmbedderOrigins_1","allowedEmbedderOrigins_1_1","origin_1","postMessage","action","url","setTimeout","_playAgainBtn","onKeyUp","onRestart","onMainMenu","timeStr","bestTimeStr","winSquare","join","hadKeyboardEvent","hadFocusVisibleRecently","hadFocusVisibleRecentlyTimeout","inputTypesWhitelist","text","search","tel","email","password","number","date","month","week","datetime","datetime-local","isValidFocusTarget","nodeName","addFocusVisibleClass","onPointerDown","e","addInitialPointerMoveListeners","onInitialPointerMove","toLowerCase","type","tagName","readOnly","isContentEditable","hasAttribute","clearTimeout","removeAttribute","visibilityState","op","Game","startTime","completeTime","computedScore","endTime","_init","previousBestTime","Win","onReset","onGameChange","componentDidUpdate","_","previousState","_tryAgainBtn","useVibration","supportsVibration","navigator","vibrate","vibrationLength","tslib_1.__awaiter","RendererClass","AnimatorClass","tslib_1.__generator","label","Promise","all","then","m","default","sent","setState","stateService","reset","restart","submitScore","scoreParam","TOUR_ID","score","options","getTournamentId","Number","tournament_id","metadata","console","log","postScore","success","alert","refreshPage","gameChange","newState","submitTime","toFixed","Object","keys","cellData","revealSurrounding","reveal","unflag","flag","metaTheme","Nebula","_timePeriod","_fadeSpeed","_colorBlend","_loopRunning","_prevColors","_initShaderbox","_onResize","colorLight","colorDark","didLightColorChange","colorEqual","didDarkColorChange","_stop","componentWillUpdate","_shaderBox","oldProps","_updateColors","style","toRGB","aria-hidden","ShaderBox","canvas","scaling","antialias","alpha","uniforms","setUniform1f","debug","nebula","setUniform4f","toShaderColor","_loop","resize","ts","draw","c1","c2","About","getCellSizes","cellPadding","cellSize","_tileSize","staticDevicePixelRatio","tileStyle","_renderCanvas","data-sprite","data-frame","data-highlight","data-border","data-circle","data-dot","href","version","motion","supportsSufficientWebGL","matchMedia","matches","innerWidth","innerHeight","deviceMemory","hardwareConcurrency","userAgent","spriteName","drawer","ctx","frame","texturePromise","dataset","sprite","idleAnimationTextureDrawer","staticTextureDrawer","getContext","save","border","circle","dot","highlight","globalCompositeOperation","fillStyle","turquoise","fillRect","restore","Settings","onCloseClicked","onMotionPrefChange","disableAnimationBtn","onVibrationPrefChange","closeBtn","focusItem","onClick","disabled","_onKeyUp","createNumberItems","numbers","Array","fill","map","i","innerSquareSizer","innerSquareItem","arr","splice","random","columns","tslib_1.__spread","letter","ShowbizTitle","nextProps","e_2","middleInners","querySelectorAll","indexLeft","indexRight","flashHeight","Set","inner","animationIterationCount","flash","animationDelay","_e","_f","e_2_1","_s","showbizTitle"],"mappings":"q8BAmBIA,EAAc,CACdC,SAAS,EACTC,SAAS,EACTC,UAAU,EACVC,cAAe,EACfC,cAAe,GAEfC,EAAuB,SAAUC,GAEjC,SAASD,IACL,IAAIE,EAAmB,OAAXD,GAAmBA,EAAOE,MAAMC,KAAMC,YAAcD,KAMhE,OALAF,EAAMI,MAAQ,CACVC,eAAe,GAEnBL,EAAMM,SAAW,GACjBN,EAAMO,sBAAwB,IAAIC,QAC3BR,EAoYX,OA5YAS,YAAkBX,EAAOC,GAUzBD,EAAMY,UAAUC,kBAAoB,WAChCC,SAASC,gBAAgBC,UAAUC,IAAI,WACvCb,KAAKc,aAAad,KAAKe,MAAMC,MAAOhB,KAAKe,MAAME,QAC/CjB,KAAKe,MAAMG,oBAAoBlB,KAAKmB,sBACpCnB,KAAKoB,gBACLpB,KAAKqB,sBACLrB,KAAKe,MAAMO,SAASC,gBAAgBvB,KAAKwB,gBAGzCC,OAAOC,SAAS,EAAG,GAEnB,IAAIC,EAAIC,KAAKC,MAAyB,GAAnB7B,KAAKe,MAAMC,OAC1Bc,EAAIF,KAAKC,MAA0B,GAApB7B,KAAKe,MAAME,QAC1Bc,EAAM/B,KAAKI,SAAS0B,EAAI9B,KAAKe,MAAMC,MAAQW,GAC/C3B,KAAKgC,SAASD,EAAK,CAAEE,eAAe,IAEpC,IAAIC,EAAWlC,KAAKmC,KAAKC,cAAc,WACvCF,EAASG,WAAaH,EAASI,YAAc,EAAIJ,EAASK,YAAc,EACxEL,EAASM,UAAYN,EAASO,aAAe,EAAIP,EAASQ,aAAe,EACzEjB,OAAOkB,iBAAiB,SAAU3C,KAAK4C,iBACvCnB,OAAOkB,iBAAiB,QAAS3C,KAAK6C,iBAE1CjD,EAAMY,UAAUsC,qBAAuB,WACnCpC,SAASC,gBAAgBC,UAAUmC,OAAO,WAC1CtB,OAAOuB,oBAAoB,SAAUhD,KAAK4C,iBAC1CnB,OAAOuB,oBAAoB,QAAShD,KAAK6C,gBACzC7C,KAAKe,MAAMkC,sBAAsBjD,KAAKmB,sBACtCnB,KAAKe,MAAMO,SAAS4B,OACpBlD,KAAKe,MAAMoC,SAASD,OACpBE,YAAUpD,KAAKqD,UAEnBzD,EAAMY,UAAU8C,sBAAwB,WACpC,OAAO,GAEX1D,EAAMY,UAAU+C,OAAS,WACrB,IAAIzD,EAAQE,KACZ,OAAQwD,IAAE,MAAO,CAAEC,eACfD,IAAE,MAAO,CAAEE,IAAK,SAAUC,GAAM,OAAQ7D,EAAM8D,gBAAkBD,GAAQF,eAAuBI,SAAU7D,KAAK8D,eAAgBC,WAAY/D,KAAK+D,eAEvJnE,EAAMY,UAAUoC,gBAAkB,WAC9B5C,KAAK8D,iBACL9D,KAAKe,MAAMO,SAAS0C,YAExBpE,EAAMY,UAAUsD,eAAiB,WAC7B9D,KAAKqB,sBACLrB,KAAKe,MAAMO,SAASC,gBAAgBvB,KAAKwB,iBAE7C5B,EAAMY,UAAUqC,eAAiB,SAAUoB,IAGlCC,mBAAkBC,iBACJ,MAAdF,EAAMG,KACW,MAAdH,EAAMG,KACQ,MAAdH,EAAMG,KACQ,MAAdH,EAAMG,KACQ,cAAdH,EAAMG,KACQ,eAAdH,EAAMG,KACQ,YAAdH,EAAMG,KACQ,cAAdH,EAAMG,KACVpE,KAAKqE,eAAeJ,EAAO,EAAG,IAGtCrE,EAAMY,UAAUW,qBAAuB,SAAUmD,GAC7C,IAAIC,EAAKC,EACT,GAAKF,EAAYG,YAAjB,CAGA,IAEI,IAAK,IAAIC,EAAKC,WAAiBL,EAAYG,aAAcG,EAAKF,EAAGG,QAASD,EAAGE,KAAMF,EAAKF,EAAGG,OAAQ,CAC/F,IAAIE,EAAKC,SAAeJ,EAAGK,MAAO,GAAItD,EAAIoD,EAAG,GAAIjD,EAAIiD,EAAG,GAAIG,EAAOH,EAAG,GAClEhD,EAAM/B,KAAKI,SAAS0B,EAAI9B,KAAKe,MAAMC,MAAQW,GAC/C3B,KAAKmF,cAAcpD,EAAKmD,EAAMvD,EAAGG,IAGzC,MAAOsD,GAASb,EAAM,CAAEc,MAAOD,WAE3B,IACQR,IAAOA,EAAGE,OAASN,EAAKE,EAAGY,SAASd,EAAGe,KAAKb,WAE1C,GAAIH,EAAK,MAAMA,EAAIc,OAEjCrF,KAAKe,MAAMoC,SAASqC,YAAYlB,EAAYG,eAEhD7E,EAAMY,UAAUM,aAAe,SAAUE,EAAOC,GAC5C,IAAIwE,EAAiB/E,SAAS0B,cAAc,WAC5CpC,KAAK0F,OAAShF,SAASiF,cAAc,SACrC3F,KAAK0F,OAAO9E,UAAUC,cACtBb,KAAK0F,OAAOE,aAAa,OAAQ,QACjC5F,KAAK0F,OAAOE,aAAa,aAAc,iBACvC,IAAK,IAAIC,EAAM,EAAGA,EAAM5E,EAAQ4E,IAAO,CACnC,IAAIC,EAAKpF,SAASiF,cAAc,MAChCG,EAAGF,aAAa,OAAQ,OACxBE,EAAGlF,UAAUC,aACb,IAAK,IAAIkF,EAAM,EAAGA,EAAM/E,EAAO+E,IAAO,CAClC,IAAIjE,EAAI+D,EACJlE,EAAIoE,EACJC,EAAKtF,SAASiF,cAAc,MAChCK,EAAGJ,aAAa,OAAQ,YACxBI,EAAGpF,UAAUC,cACb,IAAIoF,EAASvF,SAASiF,cAAc,UACpCM,EAAOrF,UAAUC,cAEjBoF,EAAOL,aAAa,WAAY,MAChCK,EAAOtD,iBAAiB,OAAQ3C,KAAKkG,mBACrClG,KAAKK,sBAAsB8F,IAAIF,EAAQ,CAACtE,EAAGG,EAAGxC,IAC9CU,KAAKmF,cAAcc,EAAQ3G,EAAaqC,EAAGG,GAC3C9B,KAAKI,SAASgG,KAAKH,GACnBD,EAAGK,YAAYJ,GACfH,EAAGO,YAAYL,GAEnBhG,KAAK0F,OAAOW,YAAYP,GAE5B9F,KAAKqD,QAAUrD,KAAKe,MAAMO,SAASgF,eACnCtG,KAAKqD,QAAQzC,UAAUC,aACvBb,KAAKmC,KAAKkE,YAAYrG,KAAKqD,SAC3BoC,EAAeY,YAAYrG,KAAK0F,QAChC1F,KAAK0F,OAAO/C,iBAAiB,UAAW3C,KAAKuG,kBAC7CvG,KAAK0F,OAAO/C,iBAAiB,QAAS3C,KAAKwG,gBAC3CxG,KAAK0F,OAAO/C,iBAAiB,UAAW3C,KAAKyG,WAC7CzG,KAAK0F,OAAO/C,iBAAiB,YAAa3C,KAAK0G,aAC/C1G,KAAK0F,OAAO/C,iBAAiB,WAAY3C,KAAK+D,YAC9C/D,KAAK0F,OAAO/C,iBAAiB,cAAe,SAAUsB,GAClD,OAAOA,EAAM0C,oBAKbzC,kBAAkBC,kBAClBnE,KAAK0F,OAAO/C,iBAAiB,YAAa3C,KAAK4G,qBAGvDhH,EAAMY,UAAUY,cAAgB,WAC5BpB,KAAKe,MAAMO,SAASuF,KAAK7G,KAAKe,MAAMC,MAAOhB,KAAKe,MAAME,SAE1DrB,EAAMY,UAAUa,oBAAsB,WAClCrB,KAAKwB,eAAiBxB,KAAKI,SAAS,GAC/B0G,QAAQ,MACRC,yBAETnH,EAAMY,UAAU0F,kBAAoB,WAChClG,KAAKe,MAAMO,SAASU,UAAU,GAAI,IAEtCpC,EAAMY,UAAUwG,eAAiB,SAAUf,GAKvC,GAHqBA,EAAOrF,UAAUqG,SAAS,kBAC3C/C,kBACAC,gBACJ,CAIA,IAAIK,EAAKQ,SAAehF,KAAKK,sBAAsB6G,IAAIjB,GAAS,GAAItE,EAAI6C,EAAG,GAAI1C,EAAI0C,EAAG,GACtFxE,KAAKe,MAAMO,SAASU,SAASL,EAAGG,QAJ5B9B,KAAKe,MAAMO,SAASU,UAAU,GAAI,IAM1CpC,EAAMY,UAAUwB,SAAW,SAAUmF,EAAa3C,GAC9C,IAAIE,QAAa,IAAPF,EAAgB,GAAKA,GAAIvC,cAAeA,OAAuB,IAAPyC,GAAwBA,EAEtF1E,KAAKoH,uBACLpH,KAAKoH,qBAAqBC,UAAY,GAE1CF,EAAYE,SAAW,EACvBrH,KAAKoH,qBAAuBD,EAC5BA,EAAYG,MAAM,CAAErF,eAAe,IAC9BA,GACDjC,KAAKuH,kBAAkBJ,GAE3BnH,KAAKgH,eAAeG,IAExBvH,EAAMY,UAAU+G,kBAAoB,SAAUxF,GAE1C,IAAIG,EAAWlC,KAAK4D,gBAChB4D,EAAgBtF,EAAS6E,wBACzBU,EAAU1F,EAAIgF,wBACdW,EAAmBF,EAAcxG,MAAQ,EACzC2G,EAAmBH,EAAcvG,OAAS,EAG1C2G,EAFaH,EAAQI,KAAOJ,EAAQzG,MAAQ,EAEvB0G,EACrBI,EAFaL,EAAQM,IAAMN,EAAQxG,OAAS,EAEvB0G,EACzBzF,EAASR,SAAS,CACdmG,KAAM3F,EAASG,WAAauF,EAC5BG,IAAK7F,EAASM,UAAYsF,EAC1BE,SAAU,YAGlBpI,EAAMY,UAAUoG,mBAAqB,SAAU3C,GAE3C,IAAIgE,EAAYhE,EAAMiE,OAEtB,GADkBlI,KAAKK,sBAAsB8H,IAAIF,GACjD,CAMA,IAAIG,EAAY1H,SAAS2H,cACPrI,KAAKK,sBAAsB8H,IAAIC,IAC9BA,IAAcH,GAE7BG,EAAUE,OAEdtI,KAAKgC,SAASiG,EAAW,CAAEhG,eAAe,SAVtCjC,KAAKkG,qBAYbtG,EAAMY,UAAU6D,eAAiB,SAAUJ,EAAOT,EAAG+E,GACjDtE,EAAMuE,kBACNvE,EAAM0C,iBAEN,IAAI8B,EAAa/H,SAAS2H,cACtBK,EAAU1I,KAAKK,sBAAsB6G,IAAIuB,GAGxCC,IACD1I,KAAKoH,qBAAqBE,QAC1BoB,EAAU1I,KAAKK,sBAAsB6G,IAAIlH,KAAKoH,uBAElD,IAAIzF,EAAI+G,EAAQ,GACZ5G,EAAI4G,EAAQ,GACZ1H,EAAQhB,KAAKe,MAAMC,MACnBC,EAASjB,KAAKe,MAAME,OAEpB0H,EAAOhH,EAAI6B,EACXoF,EAAO9G,EAAIyG,EAEf,KAAII,EAAO,GAAKA,GAAQ3H,GAAU4H,EAAO,GAAKA,GAAQ3H,GAAtD,CAGA,IAAI4H,EAAYF,EAAOC,EAAO5H,EAC1B8H,EAAU9I,KAAKI,SAASyI,GAC5B7I,KAAKgC,SAAS8G,KAElBlJ,EAAMY,UAAUgG,eAAiB,SAAUvC,GACrB,QAAdA,EAAMG,KACNpE,KAAKqE,eAAeJ,EAAO,EAAG,IAGtCrE,EAAMY,UAAU+F,iBAAmB,SAAUtC,GAIzC,GAAkB,UAAdA,EAAMG,KAAiC,MAAdH,EAAMG,IAAa,CAC5C,IAAI6B,EAASvF,SAAS2H,cACtB,IAAKpC,EACD,OAEJhC,EAAM0C,iBACN3G,KAAK+I,cAAc9C,OAEA,eAAdhC,EAAMG,KAAsC,MAAdH,EAAMG,IACzCpE,KAAKqE,eAAeJ,EAAO,EAAG,GAEX,cAAdA,EAAMG,KAAqC,MAAdH,EAAMG,IACxCpE,KAAKqE,eAAeJ,GAAQ,EAAG,GAEZ,YAAdA,EAAMG,KAAmC,MAAdH,EAAMG,IACtCpE,KAAKqE,eAAeJ,EAAO,GAAI,GAEZ,cAAdA,EAAMG,KAAqC,MAAdH,EAAMG,KACxCpE,KAAKqE,eAAeJ,EAAO,EAAG,IAMtCrE,EAAMY,UAAUiG,UAAY,SAAUxC,GAElC,IAAI+E,EAAe/E,EAAMiE,OAEzB,GADuBlI,KAAKK,sBAAsB6G,IAAI8B,GACtD,CAIA,GADA/E,EAAM0C,iBACFzC,kBAAkBC,gBAAe,CAEjC,IAAI8E,EAAevI,SAAS2H,cACVrI,KAAKK,sBAAsB8H,IAAIc,GAQ7CD,EAAeC,EALfjJ,KAAKgC,SAASgH,GAQD,IAAjB/E,EAAMgC,OAMVjG,KAAK+I,cAAcC,GAAc,GAJ7BhJ,KAAK+I,cAAcC,KAO3BpJ,EAAMY,UAAUkG,YAAc,SAAUzC,GACpCA,EAAM0C,kBAEV/G,EAAMY,UAAU0I,kBAAoB,WAChClJ,KAAKe,MAAMoI,oBAAoBnJ,KAAKe,MAAMqI,aAE9CxJ,EAAMY,UAAUuD,WAAa,SAAUE,GACnC,GAAIA,EAAMiE,SAAWlI,KAAK4D,gBAA1B,CAIA,IAAI7B,EAAMkC,EAAMiE,OAChB,GAAKlI,KAAKK,sBAAsB8H,IAAIpG,GAApC,CAGA,IAAIyC,EAAKQ,SAAehF,KAAKK,sBAAsB6G,IAAInF,GAAM,GAA0BmD,GAAlBV,EAAG,GAAQA,EAAG,GAAWA,EAAG,IAC7FU,EAAKzF,UAAYyF,EAAKvF,eAAiB,IACvCK,KAAKkJ,oBACLjF,EAAMuE,yBAVNxI,KAAKkJ,qBAabtJ,EAAMY,UAAUuI,cAAgB,SAAU9C,EAAQoD,QAClC,IAARA,IAAkBA,GAAM,GAC5B,IAAIC,EAAatJ,KAAKK,sBAAsB6G,IAAIjB,GAChDjG,KAAKe,MAAMwI,YAAYD,EAAYD,IAEvCzJ,EAAMY,UAAU2E,cAAgB,SAAUpD,EAAKmD,EAAMvD,EAAGG,GACpD,IAAI0H,EAKAA,EAJCtE,EAAKzF,SAGDyF,EAAK1F,QACE,aAEgB,IAAvB0F,EAAKvF,cACE,QAGA,GAAKuF,EAAKvF,cATVuF,EAAK3F,QAAU,OAAS,SAWxC,IAAIkK,GAAavE,EAAKzF,UACjByF,EAAKvF,eAAiBuF,EAAKxF,eAAiBwF,EAAKvF,cACtDoC,EAAI6D,aAAa,gBAAiB,IAAM6D,GACxC1H,EAAI6D,aAAa,aAAc4D,GAC/BxJ,KAAKK,sBAAsB6G,IAAInF,GAAK,GAAKmD,GAE7CwE,aAAmB,CACfC,QACD/J,EAAMY,UAAW,kBAAmB,MACvCkJ,aAAmB,CACfC,QACD/J,EAAMY,UAAW,iBAAkB,MACtCkJ,aAAmB,CACfC,QACD/J,EAAMY,UAAW,iBAAkB,MACtCkJ,aAAmB,CACfC,QACD/J,EAAMY,UAAW,uBAAwB,MAC5CkJ,aAAmB,CACfC,QACD/J,EAAMY,UAAW,oBAAqB,MACzCkJ,aAAmB,CACfC,QACD/J,EAAMY,UAAW,iBAAkB,MACtCkJ,aAAmB,CACfC,QACD/J,EAAMY,UAAW,WAAY,MAChCkJ,aAAmB,CACfC,QACD/J,EAAMY,UAAW,qBAAsB,MAC1CkJ,aAAmB,CACfC,QACD/J,EAAMY,UAAW,iBAAkB,MACtCkJ,aAAmB,CACfC,QACD/J,EAAMY,UAAW,iBAAkB,MACtCkJ,aAAmB,CACfC,QACD/J,EAAMY,UAAW,mBAAoB,MACxCkJ,aAAmB,CACfC,QACD/J,EAAMY,UAAW,YAAa,MACjCkJ,aAAmB,CACfC,QACD/J,EAAMY,UAAW,cAAe,MACnCkJ,aAAmB,CACfC,QACD/J,EAAMY,UAAW,aAAc,MAClCkJ,aAAmB,CACfC,QACD/J,EAAMY,UAAW,gBAAiB,MAC9BZ,GACTgK,aC5ZK,SAASC,EAAOC,GACnB,IAAIC,EAAUnI,KAAKC,MAAMiI,OACrBE,EAAUpI,KAAKC,MAAOiI,EAAK,IAAQ,IAGvC,OAFaC,EAAQE,WAAWC,SAAS,EAAG,KAE5B,IADHF,EAAQC,WAAWC,SAAS,EAAG,6VCDzC,IAAIC,EAAQ,SAAUpJ,GACzB,IAAIyD,EAAKzD,EAAMqJ,QAASA,OAAiB,IAAP5F,GAAwBA,EAAI6F,EAAgBC,SAAevJ,EAAO,CAAC,YACrG,OAAQyC,IAAE,MAAO+G,WAAiB,GAAIF,GAClC7G,IAAE,MAAO,CAAEC,MAAO+G,WAAkBJ,WAA4B,KAC5D5G,IAAE,MAAO,CAAEC,cAAoBgH,QAAS,aACpCjH,IAAE,OAAQ,CAAEkH,EAAG,qJAEpBC,EAAS,SAAU5J,GAAS,OAAQyC,IAAE,MAAO+G,WAAiB,CAAEE,QAAS,aAAe1J,GAC/FyC,IAAE,SAAU,CAAEoH,GAAI,KAAMC,GAAI,KAAMC,EAAG,MACrCtH,IAAE,OAAQ,CAAExC,MAAO,KAAMC,OAAQ,KAAMU,EAAG,IAAKG,EAAG,IAAKiJ,GAAI,QACpDC,EAAQ,SAAUjK,GAAS,OAAQyC,IAAE,MAAO+G,WAAiB,CAAEE,QAAS,aAAe1J,GAC9FyC,IAAE,OAAQ,CAAEkH,EAAG,4GACRO,EAAO,SAAUlK,GAAS,OAAQyC,IAAE,MAAO+G,WAAiB,CAAEE,QAAS,aAAe1J,GAC7FyC,IAAE,OAAQ,CAAEkH,EAAG,mKACRQ,EAAa,SAAUnK,GAAS,OAAQyC,IAAE,MAAO+G,WAAiB,CAAEE,QAAS,aAAe1J,GACnGyC,IAAE,OAAQ,CAAEkH,EAAG,2ICZfS,EAAsB,SAAUtL,GAEhC,SAASsL,IACL,OAAkB,OAAXtL,GAAmBA,EAAOE,MAAMC,KAAMC,YAAcD,KAwC/D,OA1CAO,YAAkB4K,EAAMtL,GAIxBsL,EAAK3K,UAAUC,kBAAoB,WAC3BT,KAAKe,MAAMqK,SACXpL,KAAKqL,eAGbF,EAAK3K,UAAU8K,0BAA4B,SAAU9G,GACjD,IAAI4G,EAAU5G,EAAG4G,QACbA,IAAYpL,KAAKe,MAAMqK,UAGvBA,EACApL,KAAKqL,cAGLrL,KAAKuL,eAGbJ,EAAK3K,UAAU8C,sBAAwB,WACnC,OAAO,GAEX6H,EAAK3K,UAAUsC,qBAAuB,WAClC9C,KAAKuL,cAETJ,EAAK3K,UAAU+C,OAAS,WACpB,OAAOC,IAAE,MAAO,CAAEgI,KAAM,SAAW,UAEvCL,EAAK3K,UAAU6K,YAAc,WACzB,IAAIvL,EAAQE,KACZA,KAAKyL,OAASC,KAAKC,MACnB3L,KAAK4L,YAAcC,YAAY,WAC3BC,sBAAsB,WAClBhM,EAAMqC,KAAK4J,YAAclC,EAAO6B,KAAKC,MAAQ7L,EAAM2L,WAExD,MAEPN,EAAK3K,UAAU+K,WAAa,WACxBS,cAAchM,KAAK4L,cAEhBT,GACTvB,aACF,SAASqC,EAAeC,GAWpB,OATiB,IAAbA,EACO,UAEW,IAAbA,EACE,YAGA,YAKf,IAAIC,EAAwB,SAAUtM,GAElC,SAASsM,IACL,OAAkB,OAAXtM,GAAmBA,EAAOE,MAAMC,KAAMC,YAAcD,KAmB/D,OArBAO,YAAkB4L,EAAQtM,GAI1BsM,EAAO3L,UAAU+C,OAAS,SAAUiB,GAChC,IAAI4H,EAAW5H,EAAG4H,SAAUC,EAAgB7H,EAAG6H,cAAeC,EAAe9H,EAAG8H,aAAcJ,EAAW1H,EAAG0H,SAAUK,EAAY/H,EAAG+H,UAAWC,EAAWhI,EAAGgI,SAAUC,EAAejI,EAAGiI,aAC1L,OAAQjJ,IAAE,MAAO,CAAEC,MAAOiJ,SAAQlB,KAAM,UACpChI,IAAE,KAAM,CAAEC,MAAOkJ,SAAS,SAC1BnJ,IAAE,MAAO,CAAEC,MAAOmJ,cAAaC,aAAcZ,EAAeC,IACxD1I,IAAEmH,EAAQ,CAAElH,MAAOqJ,eACnB,IACAV,EAASnC,WAAWC,SAASmC,EAAcpC,WAAW8C,OAAQ,KAC9D,IACAV,GACJ7I,IAAE,MAAO,CAAEC,MAAOuJ,QAAQP,GAAgBD,EACpC,CAAChJ,IAAE,MAAO,KAAMqG,EAAO2C,IAAYhJ,IAAEyH,EAAM,CAAExH,MAAO+G,cACpD,CACEhH,IAAE2H,EAAM,CAAEC,QAASkB,IACnB9I,IAAE2G,EAAO,CAAE1G,MAAO+G,WAAUJ,QAASkC,GAAgBC,QAG9DJ,GACTvC,krFCjFEqD,EAAyB,CACzB,oDACA,wCACA,gCACA,8BAEAC,EAAqB,SAAUrN,GAE/B,SAASqN,EAAInM,GACT,IAAIwD,EAAKC,EACL1E,EAAQD,EAAO0F,KAAKvF,KAAMe,IAAUf,KACpCgB,EAAQD,EAAMC,MAAOC,EAASF,EAAME,OAAQkM,EAAQpM,EAAMoM,MAC1DC,EAAaC,gBAAcrM,EAAOC,EAAQkM,GAM9C,GALArN,EAAMI,MAAQ,CACVoN,SAAUF,EACN,SACgB,WAAfA,EAA0B,MAAQpM,EAAQ,IAAMC,EAAS,IAAMkM,EAAQ,MAE5D,SAAfC,GAAyBrM,EAAMiM,KAAO,KACvB,WAAfI,GAA2BrM,EAAMiM,KAAO,KACzB,SAAfI,GAAyBrM,EAAMiM,KAAO,MACnCvL,OAAO8L,OACP,IACI,IAAK,IAAIC,EAA2B7I,WAAiBsI,GAAyBQ,EAA6BD,EAAyB3I,QAAS4I,EAA2B3I,KAAM2I,EAA6BD,EAAyB3I,OAAQ,CACxO,IAAI6I,EAAWD,EAA2BxI,MAC1CxD,OAAO8L,OAAOI,YAAY,CACtBC,OAAQ,iBACRC,IAAK,sBACNH,IAGX,MAAOtI,GAASb,EAAM,CAAEc,MAAOD,WAE3B,IACQqI,IAA+BA,EAA2B3I,OAASN,EAAKgJ,EAAyBlI,SAASd,EAAGe,KAAKiI,WAEhH,GAAIjJ,EAAK,MAAMA,EAAIc,OAIzC,OAAOvF,EAiDX,OAlFAS,YAAkB2M,EAAKrN,GAmCvBqN,EAAI1M,UAAUC,kBAAoB,WAC9BqN,WAAW,WACPrM,OAAOC,SAAS,EAAG,IACpB,GACH1B,KAAK+N,cAAczG,QACnB7F,OAAOkB,iBAAiB,QAAS3C,KAAKgO,UAE1Cd,EAAI1M,UAAUsC,qBAAuB,WACjCrB,OAAOuB,oBAAoB,QAAShD,KAAKgO,UAE7Cd,EAAI1M,UAAU+C,OAAS,SAAUiB,EAAIE,GACjBF,EAAGyJ,UAAwBzJ,EAAG0J,WAA9C,IAA0DlB,EAAOxI,EAAGwI,KAAMR,EAAWhI,EAAGgI,SAAUD,EAAY/H,EAAG+H,UAG7G4B,GAFWzJ,EAAG4I,SAEJN,GACVoB,EAAcvE,EAAO2C,GACzB,OAAQhJ,IAAE,MAAO,CAAEC,gBACfD,IAAE,MAAO,CAAEC,gBACPD,IAAE,MAAO,CAAEC,MAAO,CAAC4K,EAAW9B,EAAY,aAAe+B,KAAK,MAC1D9K,IAAE,MAAO,KACLA,IAAE,MAAO,KACLA,IAAE,MAAO,KACLA,IAAE,MAAO,KACLA,IAAE,MAAO,WAC7BA,IAAE,KAAM,CAAEC,gBACNuJ,IAASR,EAAW,kBAAoB,WACxC,KACJhJ,IAAE,MAAO,CAAEC,gBACPD,IAAE,MAAO,CAAEC,gBACPD,IAAE,MAAO,CAAEC,eAAoB,SAC/BD,IAAE,MAAO,CAAEC,gBAAoB0K,IACnC3K,IAAE2G,EAAO,CAAE1G,gBACXD,IAAE,MAAO,CAAEC,gBACPD,IAAE,MAAO,CAAEC,eAAoB,QAC/BD,IAAE,MAAO,CAAEC,gBAAoB2K,QAEnDlB,EAAI1M,UAAUwN,QAAU,SAAU/J,GACZ,MAAdA,EAAMG,IACNpE,KAAKe,MAAMkN,YAEQ,MAAdhK,EAAMG,KACXpE,KAAKe,MAAMmN,cAGnBxE,aAAmB,CACfC,QACDuD,EAAI1M,UAAW,UAAW,MACtB0M,GACTtD,igDC7Fa,WACb,IAAI2E,GAAmB,EACnBC,GAA0B,EAC1BC,EAAiC,KAEjCC,EAAsB,CACxBC,MAAM,EACNC,QAAQ,EACRf,KAAK,EACLgB,KAAK,EACLC,OAAO,EACPC,UAAU,EACVC,QAAQ,EACRC,MAAM,EACNC,OAAO,EACPC,MAAM,EACNnC,MAAM,EACNoC,UAAU,EACVC,kBAAkB,GAQpB,SAASC,EAAmB3L,GAC1B,SACEA,GACAA,IAAOjD,UACS,SAAhBiD,EAAG4L,UACa,SAAhB5L,EAAG4L,UACH,cAAe5L,GACf,aAAcA,EAAG/C,WAsCrB,SAAS4O,EAAqB7L,GACxBA,EAAG/C,UAAUqG,SAAS,mBAG1BtD,EAAG/C,UAAUC,IAAI,iBACjB8C,EAAGiC,aAAa,2BAA4B,KAsC9C,SAAS6J,EAAcC,GACrBnB,GAAmB,EAwErB,SAASoB,IACPjP,SAASiC,iBAAiB,YAAaiN,GACvClP,SAASiC,iBAAiB,YAAaiN,GACvClP,SAASiC,iBAAiB,UAAWiN,GACrClP,SAASiC,iBAAiB,cAAeiN,GACzClP,SAASiC,iBAAiB,cAAeiN,GACzClP,SAASiC,iBAAiB,YAAaiN,GACvClP,SAASiC,iBAAiB,YAAaiN,GACvClP,SAASiC,iBAAiB,aAAciN,GACxClP,SAASiC,iBAAiB,WAAYiN,GAsBxC,SAASA,EAAqBF,GAGY,SAApCA,EAAExH,OAAOqH,SAASM,gBAItBtB,GAAmB,EAzBnB7N,SAASsC,oBAAoB,YAAa4M,GAC1ClP,SAASsC,oBAAoB,YAAa4M,GAC1ClP,SAASsC,oBAAoB,UAAW4M,GACxClP,SAASsC,oBAAoB,cAAe4M,GAC5ClP,SAASsC,oBAAoB,cAAe4M,GAC5ClP,SAASsC,oBAAoB,YAAa4M,GAC1ClP,SAASsC,oBAAoB,YAAa4M,GAC1ClP,SAASsC,oBAAoB,aAAc4M,GAC3ClP,SAASsC,oBAAoB,WAAY4M,IAqB3ClP,SAASiC,iBAAiB,UAnI1B,SAAmB+M,GACbJ,EAAmB5O,SAAS2H,gBAC9BmH,EAAqB9O,SAAS2H,eAGhCkG,GAAmB,IA8H2B,GAChD7N,SAASiC,iBAAiB,YAAa8M,GAAe,GACtD/O,SAASiC,iBAAiB,cAAe8M,GAAe,GACxD/O,SAASiC,iBAAiB,aAAc8M,GAAe,GACvD/O,SAASiC,iBAAiB,QA5G1B,SAAiB+M,GA9EjB,IAAuC/L,EACjCmM,EACAC,EA8ECT,EAAmBI,EAAExH,UAItBqG,IApFiC5K,EAoFiB+L,EAAExH,OAnFpD4H,EAAOnM,EAAGmM,KAGC,UAFXC,EAAUpM,EAAGoM,UAESrB,EAAoBoB,KAAUnM,EAAGqM,UAI5C,YAAXD,IAA0BpM,EAAGqM,UAI7BrM,EAAGsM,qBAyELT,EAAqBE,EAAExH,UAqGiB,GAC5CxH,SAASiC,iBAAiB,OA9F1B,SAAgB+M,GAxDhB,IAAiC/L,EAyD1B2L,EAAmBI,EAAExH,UAKxBwH,EAAExH,OAAOtH,UAAUqG,SAAS,kBAC5ByI,EAAExH,OAAOgI,aAAa,+BAMtB1B,GAA0B,EAC1B/M,OAAO0O,aAAa1B,GACpBA,EAAiChN,OAAOqM,WAAW,WACjDU,GAA0B,EAC1B/M,OAAO0O,aAAa1B,IACnB,MA1E0B9K,EA2EL+L,EAAExH,QA1EpBgI,aAAa,8BAGrBvM,EAAG/C,UAAUmC,OAAO,iBACpBY,EAAGyM,gBAAgB,gCAiJqB,GAC1C1P,SAASiC,iBAAiB,mBAnE1B,SAA4B+M,GACM,UAA5BhP,SAAS2P,kBAKP7B,IACFD,GAAmB,GAErBoB,OA0D8D,GAClEA,IAEAjP,SAASC,gBAAgBC,UAAUC,IAAI,uBChPzC,IAAIyP,EAAK7O,OAAO6O,GACZC,EAAsB,SAAU1Q,GAEhC,SAAS0Q,EAAKxP,GACV,IAAIjB,EAAQD,EAAO0F,KAAKvF,KAAMe,IAAUf,KAWxC,OAVAF,EAAMI,MAAQ,CACVgM,SAAU,EACVE,SAAUrL,EAAMsL,cAChBmE,UAAW,EACXC,aAAc,EACdjE,SAAU,EACVkE,cAAe,EACfC,QAAS,GAEb7Q,EAAM8Q,QACC9Q,EAmNX,OAhOAS,YAAkBgQ,EAAM1Q,GAexB0Q,EAAK/P,UAAU+C,OAAS,SAAUiB,EAAIE,GAElC,IAAI0E,EAAa5E,EAAG4E,WAAYpI,EAAQwD,EAAGxD,MAAOC,EAASuD,EAAGvD,OAAQkM,EAAQ3I,EAAG2I,MAAOjM,EAAsBsD,EAAGtD,oBAAqB+B,EAAwBuB,EAAGvB,sBAAuBoJ,EAAgB7H,EAAG6H,cAAeE,EAAY/H,EAAG+H,UAAWsE,EAAmBrM,EAAGgI,SACtQN,EAAWxH,EAAGwH,SAAUE,EAAW1H,EAAG0H,SAAUjJ,EAAWuB,EAAGvB,SAAU7B,EAAWoD,EAAGpD,SAA0CoP,GAAjBhM,EAAG+L,aAA8B/L,EAAGgM,eAAelE,EAAW9H,EAAG8H,SAChLF,EAA4B,IAAbJ,EACnB,OAAQ1I,IAAE,MAAO,CAAEC,eACfD,IAAE2I,EAAQ,CAAEG,aAAcA,EAAcF,SAAUA,EAAUC,cAAeA,EAAeH,SAAUA,EAAUK,UAAWA,EAAWC,SAAUqE,EAAkBpE,aAA2B,IAAbP,IACjK,IAAbA,EAA4B1I,IAAEsN,EAAK,CAAE5C,WAAYlO,KAAK+Q,QAAS9C,UAAWjO,KAAKiO,UAAWjB,KAAM0D,EAAelE,SAAUA,EAAUxL,MAAOA,EAAOC,OAAQA,EAAQkM,MAAOA,EAAOZ,UAAWvM,KAAKe,MAAMwL,YAAgBjL,GAAY6B,GAC7NK,IAAE5D,EAAO,CAAEoB,MAAOA,EAAOC,OAAQA,EAAQmI,WAAYA,EAAYjG,SAAUA,EAAU7B,SAAUA,EAAUJ,oBAAqBA,EAAqB+B,sBAAuBA,EAAuBsG,YAAavJ,KAAKuJ,YAAaJ,mBAAoBnJ,KAAKe,MAAMoI,6BAY7P3F,IAAE,MAAO,QAEvB+M,EAAK/P,UAAUC,kBAAoB,WAC/BT,KAAKe,MAAMG,oBAAoBlB,KAAKgR,cAC/BhR,KAAKe,MAAMqI,YACZpJ,KAAKe,MAAMoI,oBAAmB,GAElC1H,OAAOkB,iBAAiB,QAAS3C,KAAKgO,UAE1CuC,EAAK/P,UAAUsC,qBAAuB,WAClC9C,KAAKe,MAAMkC,sBAAsBjD,KAAKgR,cACtCvP,OAAOuB,oBAAoB,QAAShD,KAAKgO,UAE7CuC,EAAK/P,UAAUyQ,mBAAqB,SAAUC,EAAGC,GACjB,IAAxBnR,KAAKE,MAAMgM,UACgB,IAA3BiF,EAAcjF,UACdlM,KAAKoR,eACLpR,KAAKoR,aAAa9J,QACdtH,KAAKe,MAAMsQ,cAAgBC,qBAC3BC,UAAUC,QAAQC,qBAI9BlB,EAAK/P,UAAUoQ,MAAQ,WACnB,OAAOc,YAAkB1R,UAAM,OAAQ,EAAQ,WAC3C,IAAIsB,EAAU6B,EAAUqB,EAAkCE,EAAIiN,EAAeC,EAC7E,OAAOC,cAAoB7R,KAAM,SAAU4E,GACvC,OAAQA,EAAGkN,OACP,KAAK,EACD,OAAK9R,KAAKe,MAAMwL,UACT,CAAC,EAAawF,QAAQC,IAAI,CACzB,6BAAO,2BAAqCC,KAAK,SAAUC,GAAK,OAAOA,EAAEC,UACzE,6BAAO,2BAAsCF,KAAK,SAAUC,GAAK,OAAOA,EAAEC,aAHhD,CAAC,EAAa,GAKpD,KAAK,EAID,OAHA3N,EAAKQ,SAAejF,WAAM,EAAQ,CAAC6E,EAAGwN,OAAQ,IAAKT,EAAgBnN,EAAG,GAAIoN,EAAgBpN,EAAG,GAC7FlD,EAAW,IAAIqQ,EACfxO,EAAW,IAAIyO,EAAc5R,KAAKe,MAAMC,MAAOhB,KAAKe,MAAME,OAAQK,GAC3D,CAAC,EAAa,GACzB,KAAK,EAAG,MAAO,CAAC,EAAayQ,QAAQC,IAAI,CACjC,6BAAO,2BAAyCC,KAAK,SAAUC,GAAK,OAAOA,EAAEC,UAC7E,6BAAO,2BAAyCF,KAAK,SAAUC,GAAK,OAAOA,EAAEC,aAErF,KAAK,EACDzN,EAAKM,SAAejF,WAAM,EAAQ,CAAC6E,EAAGwN,OAAQ,IAAKT,EAAgBjN,EAAG,GAAIkN,EAAgBlN,EAAG,GAC7FpD,EAAW,IAAIqQ,EACfxO,EAAW,IAAIyO,EAAc5R,KAAKe,MAAMC,MAAOhB,KAAKe,MAAME,OAAQK,GAClEsD,EAAGkN,MAAQ,EACf,KAAK,EAED,OADA9R,KAAKqS,SAAS,CAAE/Q,SAAUA,EAAU6B,SAAUA,IACvC,CAAC,SAK5BoN,EAAK/P,UAAUwN,QAAU,SAAU/J,GACb,MAAdA,EAAMG,IACsB,IAAxBpE,KAAKE,MAAMgM,UACXlM,KAAKiO,YAGU,MAAdhK,EAAMG,KACXpE,KAAK+Q,WAGbR,EAAK/P,UAAUuQ,QAAU,WACrB/Q,KAAKe,MAAMuR,aAAaC,SAE5BhC,EAAK/P,UAAUyN,UAAY,WACvBjO,KAAKe,MAAMuR,aAAaE,WAE5BjC,EAAK/P,UAAUiS,YAAc,SAAUC,GACnC,OAAOhB,YAAkB1R,UAAM,OAAQ,EAAQ,WAC3C,IAAI2S,EAASC,EAAOC,EACpB,OAAOhB,cAAoB7R,KAAM,SAAUwE,GACvC,OAAQA,EAAGsN,OACP,KAAK,EAQD,OAPAa,EAAUrC,EAAGwC,kBACbF,EAAQG,OAAOL,GACfG,EAAU,CACNG,cAAeL,EACfM,SAAU,aAAeL,EAAQ,KAErCM,QAAQC,IAAI,cAAeN,GACT,OAAZF,EAA0B,CAAC,EAAa,GACvC,CAAC,EAAarC,EAAG8C,UAAUP,IACtC,KAAK,EACMrO,EAAG4N,OACDiB,SACLC,MAAM,gCAAkCV,GAE5CpO,EAAGsN,MAAQ,EACf,KAAK,EAED,OADA9R,KAAKuT,cACE,CAAC,SAK5BhD,EAAK/P,UAAU+S,YAAc,WACzBzF,WAAW,WACPrM,OAAOsG,IAAI4F,YAAY,cAAe,MACvC,MAEP4C,EAAK/P,UAAUwQ,aAAe,SAAUwC,GACpC,OAAO9B,YAAkB1R,UAAM,OAAQ,EAAQ,WAC3C,IAAIyT,EAAUjP,EACd,OAAOqN,cAAoB7R,KAAM,SAAU0E,GACvC,OAAQA,EAAGoN,OACP,KAAK,EAED,OADA2B,EAAW,GACL,aAAcD,GAChBxT,KAAKE,MAAMgM,WAAasH,EAAWtH,UACvCuH,EAASvH,SAAWsH,EAAWtH,SACD,IAAxBsH,EAAWtH,SAAsC,CAAC,EAAa,IACrEuH,EAASjD,UAAY9E,KAAKC,MACnB,CAAC,EAAa,KAJoC,CAAC,EAAa,GAK3E,KAAK,EACD,OAA8B,IAAxB6H,EAAWtH,SAAkC,CAAC,EAAa,IACjEuH,EAAShD,aAAe/E,KAAKC,MAAQ3L,KAAKE,MAAMsQ,UAChDhM,EAAKiP,EACE,CAAC,EAAaC,aAAW1T,KAAKe,MAAMC,MAAOhB,KAAKe,MAAME,OAAQjB,KAAKe,MAAMoM,MAAOsG,EAAShD,gBACpG,KAAK,EAMD,OALAjM,EAAGgI,SAAW9H,EAAG0N,OACjBpS,KAAKe,MAAMoI,oBAAmB,GAE9BsK,EAAS/C,cAAgBqC,QAAQ,IAAUU,EAAShD,cAAckD,QAAQ,IAC1E3T,KAAKyS,YAAYgB,EAAS/C,eACnB,CAAC,EAAa,GACzB,KAAK,EAC2B,IAAxB8C,EAAWtH,UACXlM,KAAKuT,cAET7O,EAAGoN,MAAQ,EACf,KAAK,EAQD,MAPI,aAAc0B,GACdxT,KAAKE,MAAMkM,WAAaoH,EAAWpH,WACnCqH,EAASrH,SAAWoH,EAAWpH,UAE/BwH,OAAOC,KAAKJ,GAAU1G,QACtB/M,KAAKqS,SAASoB,GAEX,CAAC,SAK5BlD,EAAK/P,UAAU+I,YAAc,SAAUuK,EAAUzK,GAC7C,GAA4B,IAAxBrJ,KAAKE,MAAMgM,UACa,IAAxBlM,KAAKE,MAAMgM,SADf,CAIA,IAAI1H,EAAKQ,SAAe8O,EAAU,GAAInS,EAAI6C,EAAG,GAAI1C,EAAI0C,EAAG,GAAIU,EAAOV,EAAG,GAClE4E,EAAapJ,KAAKe,MAAMqI,WACxBC,IACAD,GAAcA,GAEblE,EAAKzF,SAaDyF,EAAKxF,eAAiBwF,EAAKvF,eAChCK,KAAKe,MAAMuR,aAAayB,kBAAkBpS,EAAGG,GAbxCsH,EAQKlE,EAAK3F,SACXS,KAAKe,MAAMuR,aAAa0B,OAAOrS,EAAGG,GAR9BoD,EAAK3F,QACLS,KAAKe,MAAMuR,aAAa2B,OAAOtS,EAAGG,GAGlC9B,KAAKe,MAAMuR,aAAa4B,KAAKvS,EAAGG,KAWhD4H,aAAmB,CACfC,QACD4G,EAAK/P,UAAW,UAAW,MAC9BkJ,aAAmB,CACfC,QACD4G,EAAK/P,UAAW,UAAW,MAC9BkJ,aAAmB,CACfC,QACD4G,EAAK/P,UAAW,YAAa,MAChCkJ,aAAmB,CACfC,QACD4G,EAAK/P,UAAW,eAAgB,MACnCkJ,aAAmB,CACfC,QACD4G,EAAK/P,UAAW,cAAe,MAC3B+P,GACT3G,gLC3NEuK,EAAYzT,SAAS0B,cAAc,4BACnCgS,EAAwB,SAAUvU,GAElC,SAASuU,IACL,IAAItU,EAAmB,OAAXD,GAAmBA,EAAOE,MAAMC,KAAMC,YAAcD,KAMhE,OALAF,EAAMuU,YAAc,IACpBvU,EAAMwU,WAAa,GACnBxU,EAAMyU,YAAc,EACpBzU,EAAM0U,cAAe,EACrB1U,EAAM2U,YAAc,GACb3U,EA6HX,OArIAS,YAAkB6T,EAAQvU,GAU1BuU,EAAO5T,UAAUC,kBAAoB,WAE7BT,KAAKe,MAAMwL,WACXvM,KAAK0U,iBAETjT,OAAOkB,iBAAiB,SAAU3C,KAAK2U,YAE3CP,EAAO5T,UAAU8C,sBAAwB,SAAUkB,GAC/C,IAAIoQ,EAAapQ,EAAGoQ,WAAYC,EAAYrQ,EAAGqQ,UAC/C,GADsErQ,EAAG+H,YACvDvM,KAAKe,MAAMwL,UACzB,OAAO,EAEX,IAAIuI,GAAuBC,EAAW/U,KAAKe,MAAM6T,WAAYA,GACzDI,GAAsBD,EAAW/U,KAAKe,MAAM8T,UAAWA,GAC3D,OAAOC,GAAuBE,GAElCZ,EAAO5T,UAAUsC,qBAAuB,WACpC9C,KAAKiV,QACLxT,OAAOuB,oBAAoB,SAAUhD,KAAK2U,YAE9CP,EAAO5T,UAAU0U,oBAAsB,WAC9BlV,KAAKmV,aAGVnV,KAAKyU,YAAc,CAACzU,KAAKe,MAAM6T,WAAY5U,KAAKe,MAAM8T,WACtD7U,KAAKuU,YAAc,IAEvBH,EAAO5T,UAAUyQ,mBAAqB,SAAUmE,GACxCpV,KAAKe,MAAMwL,YAAc6I,EAAS7I,YAC9BvM,KAAKe,MAAMwL,UACXvM,KAAK0U,iBAGL1U,KAAKiV,SAGbjV,KAAKqV,iBAETjB,EAAO5T,UAAU+C,OAAS,SAAUiB,GAChC,IAAIoQ,EAAapQ,EAAGoQ,WAAYC,EAAYrQ,EAAGqQ,UAAWtI,EAAY/H,EAAG+H,UACzE,OAAQ/I,IAAE,MAAO,CAAEC,cAAwB6R,MAAO,0CAA4CC,QAAMX,GAAc,KAAOW,QAAMV,IAActI,GAAa/I,IAAE,SAAU,CAAEC,eAAoB+R,cAAe,WAE/MpB,EAAO5T,UAAUkU,eAAiB,WAC9B,IAAI5U,EAAQE,KACZA,KAAKmV,WAAa,IAAIM,YC9Ef,sICAA,g/EF8EuD,CAC1DC,OAAQ1V,KAAKmC,KAAKC,cAAc,UAChCuT,QAAS,GACTC,WAAW,EACXC,OAAO,EACPC,SAAU,CACN,YACA,OACA,wBACA,cACA,kBACA,iBACA,iBACA,iBACA,iBACA,kBACA,kBACA,sBAGR9V,KAAKmV,WAAWY,aAAa,YAAa,GAC1C/V,KAAKmV,WAAWY,aAAa,wBAAyB,GACtD/V,KAAKmV,WAAWY,aAAa,cAAe,IAC5C/V,KAAKmV,WAAWY,aAAa,kBAAmB,IAChD/V,KAAKmV,WAAWY,aAAa,iBAAkB,GAC/C/V,KAAKmV,WAAWY,aAAa,iBAAkB,KAC/C/V,KAAKmV,WAAWY,aAAa,iBAAkB,GAC/C/V,KAAK2U,YACL3U,KAAKyU,YAAc,CAACzU,KAAKe,MAAM6T,WAAY5U,KAAKe,MAAM8T,WACtD7U,KAAKqV,gBACLrV,KAAKyL,SACDuK,SACA,6BAAO,2BAA2B/D,KAAK,SAAUC,GAC7C,OAAOA,EAAE+D,OAAOnW,EAAOA,EAAMqV,eAIzCf,EAAO5T,UAAU6U,cAAgB,WAC7B,IAAIR,EAAY7U,KAAKe,MAAM8T,UAC3BV,EAAUvO,aAAa,UAAW,OAASiP,EAAU,GAAK,KAAOA,EAAU,GAAK,KAAOA,EAAU,GAAK,KACjG7U,KAAKmV,aAGVnV,KAAKmV,WAAWe,aAAa,mBAAoBC,gBAAcnW,KAAKyU,YAAY,KAChFzU,KAAKmV,WAAWe,aAAa,kBAAmBC,gBAAcnW,KAAKyU,YAAY,KAC/EzU,KAAKmV,WAAWe,aAAa,kBAAmBC,gBAAcnW,KAAKe,MAAM6T,aACzE5U,KAAKmV,WAAWe,aAAa,iBAAkBC,gBAActB,MAEjET,EAAO5T,UAAUiL,OAAS,WAClBzL,KAAKwU,eAGTxU,KAAKwU,cAAe,EACpB1I,sBAAsB9L,KAAKoW,SAE/BhC,EAAO5T,UAAUyU,MAAQ,WACrBjV,KAAKwU,cAAe,GAExBJ,EAAO5T,UAAUmU,UAAY,WACpB3U,KAAKmV,YAGVnV,KAAKmV,WAAWkB,UAEpBjC,EAAO5T,UAAU4V,MAAQ,SAAUE,GAC/BtW,KAAKmV,WAAWY,aAAa,OAASO,EAAKtW,KAAKqU,YAAerU,KAAKqU,aACpErU,KAAKuU,cAAgB,EAAIvU,KAAKuU,aAAevU,KAAKsU,WAClDtU,KAAKmV,WAAWY,aAAa,YAAa/V,KAAKuU,aAC/CvU,KAAKmV,WAAWoB,OACZvW,KAAKwU,cACL1I,sBAAsB9L,KAAKoW,QAGnC1M,aAAmB,CACfC,QACDyK,EAAO5T,UAAW,YAAa,MAClCkJ,aAAmB,CACfC,QACDyK,EAAO5T,UAAW,QAAS,MACvB4T,GACTxK,aAEF,SAASmL,EAAWyB,EAAIC,GACpB,OAAOD,EAAG,KAAOC,EAAG,IAAMD,EAAG,KAAOC,EAAG,IAAMD,EAAG,KAAOC,EAAG,OG3I1DlF,qsBACQ9P,OAAO8P,UACnB,IAAImF,EAAuB,SAAU7W,GAEjC,SAAS6W,IACL,IAAI5W,EAAQD,EAAO0F,KAAKvF,OAASA,KAC7BwE,EAAKmS,iBAAgBC,EAAcpS,EAAGoS,YAAaC,EAAWrS,EAAGqS,SAErE,OADA/W,EAAMgX,WAAaD,EAAW,EAAID,GAAeG,yBAC1CjX,EA+KX,OApLAS,YAAkBmW,EAAO7W,GAOzB6W,EAAMlW,UAAU+C,OAAS,WACrB,OAAQC,IAAE,MAAO,CAAEC,eACfD,IAAE,KAAM,KAAM,eACdA,IAAE,MAAO,CAAEC,gBACPD,IAAE,MAAO,CAAEC,gBACPD,IAAE,SAAU,CAAEC,MAAOuT,EAAWtT,IAAK1D,KAAKiX,cAAejW,MAAOhB,KAAK8W,UAAW7V,OAAQjB,KAAK8W,UAAWI,cAAe,OAAQC,aAAc,IAAKC,iBAAkB,QAASC,cAAe,OAAQC,cAAe,OAAQC,WAAY,UACvO,cACJ/T,IAAE,MAAO,CAAEC,gBACPD,IAAE,SAAU,CAAEC,MAAOuT,EAAWtT,IAAK1D,KAAKiX,cAAejW,MAAOhB,KAAK8W,UAAW7V,OAAQjB,KAAK8W,UAAWI,cAAe,SAAUC,aAAc,IAAclN,WAAYmN,iBAAkB,QAASC,cAAe,QAASC,cAAe,QAASC,WAAY,UAChQ,eACR/T,IAAE,IAAK,KACH,+GACAA,IAAE,SAAU,KAAM,SAClB,kCACJA,IAAE,IAAK,KAAM,4NACbA,IAAE,MAAO,CAAEC,gBACPD,IAAE,MAAO,CAAEC,gBACPD,IAAE,SAAU,CAAEC,MAAOuT,EAAWtT,IAAK1D,KAAKiX,cAAejW,MAAOhB,KAAK8W,UAAW7V,OAAQjB,KAAK8W,UAAWI,cAAe,OAAQC,aAAc,IAAKC,iBAAkB,QAASC,cAAe,OAAQC,cAAe,UACnN,WACJ9T,IAAE,MAAO,CAAEC,gBACPD,IAAE,SAAU,CAAEC,MAAOuT,EAAWtT,IAAK1D,KAAKiX,cAAejW,MAAOhB,KAAK8W,UAAW7V,OAAQjB,KAAK8W,UAAWI,cAAe,SAAUC,aAAc,GAAiBlN,WAAYmN,iBAAkB,QAASC,cAAe,QAASC,cAAe,QAASC,WAAY,UACnQ,SACR/T,IAAE,IAAK,KACH,uHACA,IACAA,IAAE,SAAU,KAAM,QAClB,8CACJA,IAAE,IAAK,KAAM,yDACbA,IAAE,MAAO,CAAEC,gBACPD,IAAE,MAAO,CAAEC,gBACPD,IAAE,SAAU,CAAEC,MAAOuT,EAAWtT,IAAK1D,KAAKiX,cAAejW,MAAOhB,KAAK8W,UAAW7V,OAAQjB,KAAK8W,UAAWI,cAAe,OAAQC,aAAc,IAAKC,iBAAkB,OAAQC,cAAe,OAAQC,cAAe,OAAQC,WAAY,SACtO,WACJ/T,IAAE,MAAO,CAAEC,gBACPD,IAAE,SAAU,CAAEC,MAAOuT,EAAWtT,IAAK1D,KAAKiX,cAAejW,MAAOhB,KAAK8W,UAAW7V,OAAQjB,KAAK8W,UAAWI,cAAe,SAAUC,aAAc,GAAiBlN,WAAYmN,iBAAkB,OAAQC,cAAe,QAASC,cAAe,QAASC,WAAY,UAClQ,gBACR/T,IAAE,IAAK,KAAM,4LACbA,IAAE,KAAM,KAAM,aACdU,iBAAkBV,IAAE,KAAM,CAAEC,eACxBD,IAAE,KAAM,KACJA,IAAE,OAAQ,CAAEC,eAAyBoJ,aAAc,SAAW,KAC9D,WACJrJ,IAAE,KAAM,KACJA,IAAE,OAAQ,CAAEC,eAAyBoJ,aAAc,SAAW,KAC9D,aACJrJ,IAAE,KAAM,KACJA,IAAE,OAAQ,CAAEC,eAAyBoJ,aAAc,SAAW,KAC9D,aACJrJ,IAAE,KAAM,KACJA,IAAE,OAAQ,CAAEC,eAAyBoJ,aAAc,SAAW,KAC9D,cACJrJ,IAAE,KAAM,KACJA,IAAE,OAAQ,CAAEC,eAAyBoJ,aAAc,SAAW,KAC9D,8BACJrJ,IAAE,KAAM,KACJA,IAAE,OAAQ,CAAEC,eAAyBoJ,aAAc,SAAW,KAC9D,uCAA2CrJ,IAAE,KAAM,CAAEC,eACzDD,IAAE,KAAM,KACJA,IAAE,OAAQ,CAAEC,eAAyBoJ,aAAc,SAAW,KAC9D,sCACJrJ,IAAE,KAAM,KACJA,IAAE0H,EAAY,CAAEzH,eAA0BoJ,aAAc,gBACxD,yDACRrJ,IAAE,KAAM,KAAM,UACdA,IAAE,IAAK,KACH,kCACA,IACAA,IAAE,IAAK,CAAEgU,KAAM,6CAA+C,qBAC9D,KACJhU,IAAE,KAAM,KAAM,kBACdA,IAAE,IAAK,KACH,qCACA,IACAA,IAAE,IAAK,CAAEgU,KAAM,yEAA2E,oBAC1F,sGACJhU,IAAE,KAAM,KAAM,UACdA,IAAE,IAAK,KAAM,+BACbA,IAAE,IAAK,KACH,aACAA,IAAE,IAAK,CAAEgU,KAAM,+BAAiC,cAChD,mCACJhU,IAAE,KAAM,KAAM,sBACdA,IAAE,KAAM,CAAEC,eACND,IAAE,KAAM,KACJ,YACAiU,WACJjU,IAAE,KAAM,KACJ,WACAxD,KAAKe,MAAM2W,OAAS,OAAS,SACjClU,IAAE,KAAM,KACJ,kBACA,IACAxD,KAAKe,MAAM4W,wBAA0B,OAAS,SAClDnU,IAAE,KAAM,KACJ,kBACAU,iBAAiB,MAAQ,MAC7BV,IAAE,KAAM,KACJ,mBACA,IACA/B,OAAOmW,WAAW,8BAA8BC,QAC1C,MACA,MACVrU,IAAE,KAAM,KACJ,iBACA/B,OAAOqW,WACP,MACJtU,IAAE,KAAM,KACJ,kBACA/B,OAAOsW,YACP,MACJvU,IAAE,KAAM,KACJ,QACAuT,0BACJvT,IAAE,KAAM,KACJ,kBACA+N,EAAUyG,cACdxU,IAAE,KAAM,KACJ,gBACA+N,EAAU0G,qBACdzU,IAAE,KAAM,KACJ,OACA+N,EAAU2G,cAE1BxB,EAAMlW,UAAUyW,cAAgB,SAAUvB,GACtC,OAAOhE,YAAkB1R,UAAM,OAAQ,EAAQ,WAC3C,IAAImY,EAAYC,EAAQC,EAAKC,EAC7B,OAAOzG,cAAoB7R,KAAM,SAAUwE,GACvC,OAAQA,EAAGsN,OACP,KAAK,EAAG,MAAO,CAAC,EAAa9R,KAAKe,MAAMwX,gBACxC,KAAK,EAID,OAHA/T,EAAG4N,OACH+F,EAAazC,EAAO8C,QAAQC,OAC5BL,EAAS,KACDD,GACJ,IAAK,OACDC,EAASM,6BACT,MACJ,IAAK,SACDN,EAASO,sBA4BjB,OAzBAN,EAAM3C,EAAOkD,WAAW,OACpBC,OACAT,IACAE,EAAQvF,OAAO2C,EAAO8C,QAAQF,OAC9BF,EAAOE,EAAOD,EAAKrY,KAAK8W,YAEwB,SAAxCpB,EAAO8C,QAAQM,OAAOjJ,eAE9B8I,sBAAoB,EAAiBN,EAAKrY,KAAK8W,WAEC,SAAxCpB,EAAO8C,QAAQO,OAAOlJ,eAE9B8I,sBAAoB,GAAuBN,EAAKrY,KAAK8W,WAEX,SAArCpB,EAAO8C,QAAQQ,IAAInJ,eAExB8I,sBAAoB,GAAcN,EAAKrY,KAAK8W,WAEU,SAA3CpB,EAAO8C,QAAQS,UAAUpJ,gBAEpCwI,EAAIa,yBAA2B,cAC/Bb,EAAIc,UAAYC,YAChBf,EAAIgB,SAAS,EAAG,EAAGrZ,KAAK8W,UAAW9W,KAAK8W,YAE5CuB,EAAIiB,UACG,CAAC,SAK5B5P,aAAmB,CACfC,QACD+M,EAAMlW,UAAW,gBAAiB,MAC9BkW,GACT9M,k1DC1LF,IAAI2P,EAA0B,SAAU1Z,GAEpC,SAAS0Z,IACL,OAAkB,OAAX1Z,GAAmBA,EAAOE,MAAMC,KAAMC,YAAcD,KAsC/D,OAxCAO,YAAkBgZ,EAAU1Z,GAI5B0Z,EAAS/Y,UAAU+C,OAAS,SAAUiB,GAClC,IAAI1E,EAAQE,KACRwZ,EAAiBhV,EAAGgV,eAAgBC,EAAqBjV,EAAGiV,mBAAoB/B,EAASlT,EAAGkT,OAAQa,EAAiB/T,EAAG+T,eAAgBZ,EAA0BnT,EAAGmT,wBAAyB+B,EAAsBlV,EAAGkV,oBAAqBrI,EAAe7M,EAAG6M,aAAcsI,EAAwBnV,EAAGmV,sBACvSC,EAAW1V,iBAAkBV,IAAE,SAAU,CAAEqJ,aAAc,eAAgBnJ,IAAK,SAAUmW,GAAa,OAAQ/Z,EAAM+Z,UAAYA,GAAepW,qBAAwBqW,QAASN,GAC/KhW,IAAE,OAAQ,CAAEC,qBAA2B,KACvC,UAAcD,IAAE,SAAU,CAAEqJ,aAAc,eAAgBnJ,IAAK,SAAUmW,GAAa,OAAQ/Z,EAAM+Z,UAAYA,GAAepW,4BAAsBqW,QAASN,GAC9JhW,IAAEwH,EAAO,OACb,OAAQxH,IAAE,MAAO,CAAEgI,KAAM,SAAUqB,aAAc,kBAAmBpJ,eAChED,IAAE,MAAO,CAAEC,MAAOS,kCAAgE0V,GAClFpW,IAAE,MAAO,CAAEC,eACPD,IAAE,MAAO,CAAEC,gBACPD,IAAE,KAAM,KAAM,YACdA,IAAE,SAAU,CAAEC,MAAOiU,8CAAmCoC,QAASL,EAAoBM,SAAUL,GAC3F,cACAhC,EAAS,KAAO,OACpBlU,IAAE,SAAU,CAAEC,MAAO4N,8CAAyCyI,QAASH,EAAuBI,UAAWzI,qBACrG,WACAD,EAAe,KAAO,OAC1B7N,IAAEkT,EAAO,CAAEgB,OAAQA,EAAQa,eAAgBA,EAAgBZ,wBAAyBA,QAEpG4B,EAAS/Y,UAAUC,kBAAoB,WACnCgB,OAAOC,SAAS,EAAG,GACnB1B,KAAK6Z,UAAUvS,QACf7F,OAAOkB,iBAAiB,QAAS3C,KAAKga,WAE1CT,EAAS/Y,UAAUsC,qBAAuB,WACtCrB,OAAOuB,oBAAoB,QAAShD,KAAKga,WAE7CT,EAAS/Y,UAAUwZ,SAAW,SAAU/V,GAClB,WAAdA,EAAMG,KAAkC,MAAdH,EAAMG,KAChCpE,KAAKe,MAAMyY,kBAGnB9P,aAAmB,CACfC,QACD4P,EAAS/Y,UAAW,WAAY,MAC5B+Y,GACT3P,kyCC3CF,SAASqQ,IACL,IAAIC,EAAUC,MAAM,GACfC,KAAK,MACLC,IAAI,SAAUnJ,EAAGoJ,GAAK,OAAOA,EAAI,IACtC,OAAOH,MAAM,GACRC,KAAK,MACLC,IAAI,WAAc,OAAQ7W,IAAE,MAAO,CAAEC,MAAO8W,GAC7C/W,IAAE,MAAO,CAAEC,MAAO+W,IAVJC,EAUoCP,GAT3CQ,OAAO9Y,KAAKC,MAAMD,KAAK+Y,SAAWF,EAAI1N,QAAS,GAAG,KADjE,IAAsB0N,IAYtB,IAAIG,EAAUC,WAbF,SAa0BR,IAAI,SAAUS,GAAU,OAAQtX,IAAE,MAAO,CAAEC,gBAC7ED,IAAE,MAAO,CAAEC,gBACPD,IAAE,MAAO,CAAEC,MAAO8W,GACd/W,IAAE,MAAO,CAAEC,MAAO+W,GAAmBM,IACzCb,QAEJc,EAA8B,SAAUlb,GAExC,SAASkb,IACL,OAAkB,OAAXlb,GAAmBA,EAAOE,MAAMC,KAAMC,YAAcD,KA0E/D,OA5EAO,YAAkBwa,EAAclb,GAIhCkb,EAAava,UAAU8C,sBAAwB,SAAU0X,GACrD,OAAOhb,KAAKe,MAAM2W,SAAWsD,EAAUtD,QAE3CqD,EAAava,UAAUC,kBAAoB,WAWvC,IAVA,IAAI8D,EAAKC,EAAIyW,EAAKvW,EAKdwW,EAAeL,WAAiB7a,KAAKmC,KAAKgZ,iBAAiB,YAC3DC,EAAY,EACZC,EAAa,EACbrO,EALmB,IAMnBsO,EAAc,IACXF,GAAa,GAAG,CACnB,IACI,IAAK,IAAIxW,GAAML,OAAM,EAAQI,WAAiB,IAAI4W,IAAI,CAACH,EAAWC,MAAgBtW,EAAKH,EAAGC,QAASE,EAAGD,KAAMC,EAAKH,EAAGC,OAAQ,EAEpH2W,EAAQN,EADKnW,EAAGE,QAEd7C,cAAc,WAAyBkT,MAAMmG,wBAC/CzO,EAdG,IAcmB,GAC1B,IAAI0O,EAAQF,EAAMpZ,cAAc,WAChCsZ,EAAMpG,MAAMqG,eAAiB3O,EAAO,KACpC0O,EAAMpG,MAAMrU,OAASqa,EAAc,KAG3C,MAAOlW,GAASb,EAAM,CAAEc,MAAOD,WAE3B,IACQL,IAAOA,EAAGD,OAASN,EAAKI,EAAGU,SAASd,EAAGe,KAAKX,WAE1C,GAAIL,EAAK,MAAMA,EAAIc,OAEjC+V,IACAC,IACAC,GAAe,IACftO,GA5BkB,GAkCtB,IAHAA,GAAQ,IACRoO,EAAY,EACZC,EAAa,EACND,GAAa,GAAG,CACnB,IACI,IAAK,IAAIQ,GAAMX,OAAM,EAAQtW,WAAiB,IAAI4W,IAAI,CAACH,EAAWC,MAAgBQ,EAAKD,EAAG/W,QAASgX,EAAG/W,KAAM+W,EAAKD,EAAG/W,OAAQ,CACxH,IACI2W,GAAAA,EAAQN,EADAW,EAAG5W,QAET7C,cAAc,WAA0BkT,MAAMqG,eAAiB3O,EAAO,MAGpF,MAAO8O,GAASb,EAAM,CAAE5V,MAAOyW,WAE3B,IACQD,IAAOA,EAAG/W,OAASJ,EAAKkX,EAAGtW,SAASZ,EAAGa,KAAKqW,WAE1C,GAAIX,EAAK,MAAMA,EAAI5V,OAEjC+V,IACAC,IACArO,GAAQ,MAGhB+N,EAAava,UAAU+C,OAAS,SAAUiB,EAAIuX,GAC1C,IAAIrE,EAASlT,EAAGkT,OAChB,OAAQlU,IAAE,MAAO,CAAEC,MAAOuY,WAAsBtE,WAAwB,IAAKlM,KAAM,UAAWqB,aAAc,SACxGrJ,IAAE,MAAO,CAAEC,eAA0B+R,cAAe,QAChDhS,IAAE,MAAO,CAAEC,gBAAcoX,WA1F7B,SA0FqDR,IAAI,SAAUnJ,EAAGoJ,GAAK,OAAQ9W,IAAE,MAAO,CAAEC,gBACtFD,IAAE,MAAO,CAAEC,gBACPmX,EAAQN,GACR9W,IAAE,MAAO,CAAEC,iBACXD,IAAE,MAAO,CAAEC,yBAExBsX,GACTnR"}