{"version":3,"file":"chunk-740044b8.js","sources":["../src/main/utils/constants.ts","../src/main/utils/static-display.ts","../node_modules/idb-keyval/dist/idb-keyval.mjs","../node_modules/style-inject/dist/style-inject.es.js"],"sourcesContent":["/**\n * Copyright 2019 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// WARNING: This module is part of the main bundle. Avoid adding to it if possible.\nvar url = new URL(location.href);\nexport var debug = url.searchParams.has(\"debug\");\nexport var noCache = url.searchParams.has(\"no-cache\");\nexport var cellFocusMode = url.searchParams.has(\"cell-focus\");\nexport var fpmode = url.searchParams.has(\"fpmode\");\nvar forceMotionParam = url.searchParams.get(\"motion\");\nexport var forceMotionMode = forceMotionParam === \"0\"\n    ? false\n    : forceMotionParam === \"1\"\n        ? true\n        : undefined;\nexport var vibrationLength = 300;\n//# sourceMappingURL=constants.js.map","/**\n * Copyright 2019 Google Inc. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *     http://www.apache.org/licenses/LICENSE-2.0\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// WARNING: This module is part of the main bundle. Avoid adding to it if possible.\nimport { fpmode } from \"./constants\";\n// `devicePixelRatio` can change throughout the lifetime of a page. For example\n// when a browser window is moved from a low-DPI monitor to a high-DPI monitor.\n// Our rendering relies on dPR to generate the sprite sheets at the right\n// resolution. If the value changes, the rendering gets messed up. The easy fix\n// for now that is implemented here is to take a copy of dPR at the start of the\n// game and ignore changes thereafter. In the future we can consider detecting\n// changes to dPR and regenerating the sprite sheets on the fly.\nexport var staticDevicePixelRatio = Math.min(devicePixelRatio, 2);\n// On KaiOS browser, zoom in/out changes both screen.width and window.innerWidth.\n// This makes it hard to detect an actual screen size in order to provide\n// better visual guide (such as focus on mouse hover) for the smaller screen.\n//\n// Since zoom level is set to default every time a page gets loaded,\n// implementation below stores initial screen width and height.\nvar staticScreenWidth = screen.width;\nvar staticScreenHeight = screen.height;\n// Our assumption here is that every feature phone has qvga or less screen size,\n// so this says nothing about the input interface and may be busted in the future.\n// in Q1 2019, all KaiOS devices ship with QVGA and Xiaomi's Qin1 is also QVGA.\n// IF query pram `fpmode` was passed, force the app to be in feature phone mode.\nexport var isFeaturePhone = fpmode || Math.min(staticScreenWidth, staticScreenHeight) <= 240;\n//# sourceMappingURL=static-display.js.map","class Store {\r\n    constructor(dbName = 'keyval-store', storeName = 'keyval') {\r\n        this.storeName = storeName;\r\n        this._dbp = new Promise((resolve, reject) => {\r\n            const openreq = indexedDB.open(dbName, 1);\r\n            openreq.onerror = () => reject(openreq.error);\r\n            openreq.onsuccess = () => resolve(openreq.result);\r\n            // First time setup: create an empty object store\r\n            openreq.onupgradeneeded = () => {\r\n                openreq.result.createObjectStore(storeName);\r\n            };\r\n        });\r\n    }\r\n    _withIDBStore(type, callback) {\r\n        return this._dbp.then(db => new Promise((resolve, reject) => {\r\n            const transaction = db.transaction(this.storeName, type);\r\n            transaction.oncomplete = () => resolve();\r\n            transaction.onabort = transaction.onerror = () => reject(transaction.error);\r\n            callback(transaction.objectStore(this.storeName));\r\n        }));\r\n    }\r\n}\r\nlet store;\r\nfunction getDefaultStore() {\r\n    if (!store)\r\n        store = new Store();\r\n    return store;\r\n}\r\nfunction get(key, store = getDefaultStore()) {\r\n    let req;\r\n    return store._withIDBStore('readonly', store => {\r\n        req = store.get(key);\r\n    }).then(() => req.result);\r\n}\r\nfunction set(key, value, store = getDefaultStore()) {\r\n    return store._withIDBStore('readwrite', store => {\r\n        store.put(value, key);\r\n    });\r\n}\r\nfunction del(key, store = getDefaultStore()) {\r\n    return store._withIDBStore('readwrite', store => {\r\n        store.delete(key);\r\n    });\r\n}\r\nfunction clear(store = getDefaultStore()) {\r\n    return store._withIDBStore('readwrite', store => {\r\n        store.clear();\r\n    });\r\n}\r\nfunction keys(store = getDefaultStore()) {\r\n    const keys = [];\r\n    return store._withIDBStore('readonly', store => {\r\n        // This would be store.getAllKeys(), but it isn't supported by Edge or Safari.\r\n        // And openKeyCursor isn't supported by Safari.\r\n        (store.openKeyCursor || store.openCursor).call(store).onsuccess = function () {\r\n            if (!this.result)\r\n                return;\r\n            keys.push(this.result.key);\r\n            this.result.continue();\r\n        };\r\n    }).then(() => keys);\r\n}\n\nexport { Store, get, set, del, clear, keys };\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n"],"names":["url","URL","location","href","debug","searchParams","has","noCache","cellFocusMode","fpmode","forceMotionParam","get","forceMotionMode","undefined","staticDevicePixelRatio","Math","min","devicePixelRatio","staticScreenWidth","screen","width","staticScreenHeight","height","isFeaturePhone","Store","[object Object]","dbName","storeName","this","_dbp","Promise","resolve","reject","openreq","indexedDB","open","onerror","error","onsuccess","result","onupgradeneeded","createObjectStore","type","callback","then","db","transaction","oncomplete","onabort","objectStore","store","getDefaultStore","styleInject","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","key","_withIDBStore","delete","req","value","put"],"mappings":"kEAaA,IAAIA,EAAM,IAAIC,IAAIC,SAASC,MAChBC,EAAQJ,EAAIK,aAAaC,IAAI,SAC7BC,EAAUP,EAAIK,aAAaC,IAAI,YAC/BE,EAAgBR,EAAIK,aAAaC,IAAI,cACrCG,EAAST,EAAIK,aAAaC,IAAI,UACrCI,EAAmBV,EAAIK,aAAaM,IAAI,UACjCC,EAAuC,MAArBF,IAEF,MAArBA,QAEIG,GCFCC,EAAyBC,KAAKC,IAAIC,iBAAkB,GAO3DC,EAAoBC,OAAOC,MAC3BC,EAAqBF,OAAOG,OAKrBC,EAAiBd,GAAUM,KAAKC,IAAIE,EAAmBG,IAAuB,IClCzF,MAAMG,EACFC,YAAYC,EAAS,eAAgBC,EAAY,UAC7CC,KAAKD,UAAYA,EACjBC,KAAKC,KAAO,IAAIC,QAAQ,CAACC,EAASC,KAC9B,MAAMC,EAAUC,UAAUC,KAAKT,EAAQ,GACvCO,EAAQG,QAAU,KAAMJ,EAAOC,EAAQI,QACvCJ,EAAQK,UAAY,KAAMP,EAAQE,EAAQM,SAE1CN,EAAQO,gBAAkB,MACtBP,EAAQM,OAAOE,kBAAkBd,OAI7CF,cAAciB,EAAMC,GAChB,OAAOf,KAAKC,KAAKe,KAAKC,GAAM,IAAIf,QAAQ,CAACC,EAASC,KAC9C,MAAMc,EAAcD,EAAGC,YAAYlB,KAAKD,UAAWe,GACnDI,EAAYC,WAAa,KAAMhB,KAC/Be,EAAYE,QAAUF,EAAYV,QAAU,KAAMJ,EAAOc,EAAYT,QACrEM,EAASG,EAAYG,YAAYrB,KAAKD,gBAIlD,IAAIuB,EACJ,SAASC,IAGL,OAFKD,IACDA,EAAQ,IAAI1B,GACT0B,EC1BX,SAASE,EAAYC,EAAKC,QACX,IAARA,IAAiBA,EAAM,IAC5B,IAAIC,EAAWD,EAAIC,SAEnB,GAAKF,GAA2B,oBAAbG,SAAnB,CAEA,IAAIC,EAAOD,SAASC,MAAQD,SAASE,qBAAqB,QAAQ,GAC9DC,EAAQH,SAASI,cAAc,SACnCD,EAAMjB,KAAO,WAEI,QAAba,GACEE,EAAKI,WACPJ,EAAKK,aAAaH,EAAOF,EAAKI,YAKhCJ,EAAKM,YAAYJ,GAGfA,EAAMK,WACRL,EAAMK,WAAWC,QAAUZ,EAE3BM,EAAMI,YAAYP,SAASU,eAAeb,28EDgB9C,SAAac,EAAKjB,EAAQC,KACtB,OAAOD,EAAMkB,cAAc,YAAalB,IACpCA,EAAMmB,OAAOF,wFAbrB,SAAaA,EAAKjB,EAAQC,KACtB,IAAImB,EACJ,OAAOpB,EAAMkB,cAAc,WAAYlB,IACnCoB,EAAMpB,EAAMvC,IAAIwD,KACjBvB,KAAK,IAAM0B,EAAI/B,+MAEtB,SAAa4B,EAAKI,EAAOrB,EAAQC,KAC7B,OAAOD,EAAMkB,cAAc,YAAalB,IACpCA,EAAMsB,IAAID,EAAOJ,mKFZI"}